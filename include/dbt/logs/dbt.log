[0m12:02:11.383130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc2f3e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc2aa8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc34ba1d0>]}


============================== 12:02:11.386543 | 4c2192fc-9f3f-4da1-a72d-53be1ce546bc ==============================
[0m12:02:11.386543 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:02:11.388753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m12:02:11.421809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c2192fc-9f3f-4da1-a72d-53be1ce546bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc305b390>]}
[0m12:02:11.453409 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ims7m500'
[0m12:02:11.456077 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:02:12.036552 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:02:12.041378 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:02:12.201207 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:02:12.214894 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:02:15.301786 [info ] [MainThread]: Installed from version 1.1.1
[0m12:02:15.322514 [info ] [MainThread]: Up to date!
[0m12:02:15.326274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c2192fc-9f3f-4da1-a72d-53be1ce546bc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc2db7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc2f48e50>]}
[0m12:02:15.333783 [debug] [MainThread]: Command `dbt deps` succeeded at 12:02:15.333282 after 3.98 seconds
[0m12:02:15.336647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc2c13550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc6bbcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc2dc67d0>]}
[0m12:02:15.339310 [debug] [MainThread]: Flushing usage events
[0m12:02:39.930654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d567910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02f127850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d885610>]}


============================== 12:02:39.933321 | 04d7b552-b1fb-4796-a3a6-6b6cd03a360a ==============================
[0m12:02:39.933321 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:02:39.935665 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False'}
[0m12:02:41.769951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04d7b552-b1fb-4796-a3a6-6b6cd03a360a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02b2e7c90>]}
[0m12:02:41.796797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04d7b552-b1fb-4796-a3a6-6b6cd03a360a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02da3b8d0>]}
[0m12:02:41.799582 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:02:41.836096 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:02:41.842869 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:02:41.845380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04d7b552-b1fb-4796-a3a6-6b6cd03a360a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02b2e7490>]}
[0m12:02:43.336006 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m12:02:43.354532 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m12:02:43.361207 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_driver.sql
[0m12:02:43.367326 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m12:02:43.372872 [debug] [MainThread]: 1603: static parser failed on transform/fct_trafic.sql
[0m12:02:43.380256 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_trafic (models/transform/fct_trafic.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m12:02:43.382742 [debug] [MainThread]: Command `dbt run` failed at 12:02:43.382537 after 3.47 seconds
[0m12:02:43.384358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d863690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02b1a4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d86c410>]}
[0m12:02:43.385960 [debug] [MainThread]: Flushing usage events
[0m12:05:49.795502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef67688890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef67689c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6753e310>]}


============================== 12:05:49.798144 | f210763c-2bea-463c-8e70-a25ca6157659 ==============================
[0m12:05:49.798144 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:05:49.800310 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default'}
[0m12:05:50.387367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f210763c-2bea-463c-8e70-a25ca6157659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef64f1c850>]}
[0m12:05:50.410300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f210763c-2bea-463c-8e70-a25ca6157659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef650e21d0>]}
[0m12:05:50.413232 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:05:50.439140 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:05:50.444632 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:05:50.449496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f210763c-2bea-463c-8e70-a25ca6157659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef64f31c50>]}
[0m12:05:51.669881 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m12:05:51.687415 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m12:05:51.693557 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_driver.sql
[0m12:05:51.699237 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m12:05:51.704260 [debug] [MainThread]: 1603: static parser failed on transform/fct_trafic.sql
[0m12:05:51.710350 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_trafic (models/transform/fct_trafic.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m12:05:51.712804 [debug] [MainThread]: Command `dbt run` failed at 12:05:51.712615 after 1.93 seconds
[0m12:05:51.714385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6763ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef67523510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef64fc7690>]}
[0m12:05:51.716010 [debug] [MainThread]: Flushing usage events
[0m12:06:15.783623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e1771bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e1aacb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e166ba90>]}


============================== 12:06:15.786862 | b4071926-4702-4cf8-9cf1-0e531bd40f05 ==============================
[0m12:06:15.786862 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:06:15.789556 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m12:06:16.393789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df322dd0>]}
[0m12:06:16.417435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e1aad950>]}
[0m12:06:16.420984 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:06:16.447330 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:06:16.452250 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:06:16.454074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df32ebd0>]}
[0m12:06:17.676764 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m12:06:17.694360 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m12:06:17.700214 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_driver.sql
[0m12:06:17.706433 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m12:06:17.712274 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:06:17.808664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e1a62b10>]}
[0m12:06:17.830062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df268650>]}
[0m12:06:17.831810 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:06:17.833925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e481be10>]}
[0m12:06:17.837109 [info ] [MainThread]: 
[0m12:06:17.839420 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:06:17.843808 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:06:17.847494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:18.747110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:06:18.761744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:19.466356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e178d9d0>]}
[0m12:06:19.480454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:19.482863 [info ] [MainThread]: 
[0m12:06:19.490932 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:06:19.493152 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:06:19.495792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:06:19.498588 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:06:19.509240 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:06:19.533949 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:06:19.500800 => 12:06:19.532391
[0m12:06:19.536950 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:06:19.585716 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:06:19.603921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:19.608028 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

SELECT
    Accident_Index AS weatherID
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition

FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:06:20.575494 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "Weather_Conditions" at [16:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "Weather_Conditions" at [16:5]')
[0m12:06:21.904276 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:47041861-aae4-4c0a-960c-9afadb1bdecf&page=queryresults
[0m12:06:21.908227 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:06:19.538623 => 12:06:21.907809
[0m12:06:21.949402 [debug] [Thread-1 (]: Database Error in model dim_Weather (models/transform/dim_Weather.sql)
  Syntax error: Expected ")" but got identifier "Weather_Conditions" at [16:5]
  compiled Code at target/run/retail/models/transform/dim_Weather.sql
[0m12:06:21.954117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80de36c410>]}
[0m12:06:21.956247 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model retail.dim_Weather ....................... [[31mERROR[0m in 2.46s]
[0m12:06:21.958659 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:06:21.960634 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:06:21.962364 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:06:21.964984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:06:21.967174 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:06:21.972226 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:06:21.976960 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:06:21.968778 => 12:06:21.976646
[0m12:06:21.978390 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:06:21.983566 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:06:21.988740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:21.992251 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
SELECT
    Accident_Index AS dateID
    Year AS year,
    MONTH(Date) AS month,
    Day_of_Week AS week_day,
    DAY(Date) AS day,
    Time as time
  FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
  WHERE Accident_Index IS NOT NULL
    );
  
[0m12:06:22.721719 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "Year" at [17:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "Year" at [17:5]')
[0m12:06:23.847958 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:8ed791ae-65df-4b0f-a59c-975cabe2bdf5&page=queryresults
[0m12:06:23.852348 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:06:21.979596 => 12:06:23.851955
[0m12:06:23.859582 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got identifier "Year" at [17:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:06:23.861968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df21a4d0>]}
[0m12:06:23.863967 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 1.90s]
[0m12:06:23.866055 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:06:23.868431 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:06:23.870787 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:06:23.873483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:06:23.875837 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:06:23.883648 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:06:23.892697 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:06:23.877301 => 12:06:23.892225
[0m12:06:23.894339 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:06:23.909782 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:06:23.915318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:23.919451 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:06:27.336616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:74f12161-14a1-4ac5-92f7-97d088f463e7&page=queryresults
[0m12:06:27.356739 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:06:23.895651 => 12:06:27.356460
[0m12:06:27.359556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df32fad0>]}
[0m12:06:27.362072 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.49s]
[0m12:06:27.364418 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:06:27.368005 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:06:27.370638 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:06:27.374357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:06:27.377800 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:06:27.383229 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:06:27.389924 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:06:27.379354 => 12:06:27.389322
[0m12:06:27.391944 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:06:27.397440 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:06:27.403170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:27.409136 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make
    v.Age_of_Vehicle as vehicle_aga
FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
ON a.Accident_Index = v.Accident_Index
    );
  
[0m12:06:28.152598 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "." at [16:6]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "." at [16:6]')
[0m12:06:29.463674 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:042cbad5-997a-4d08-b8aa-0b64a155ce8e&page=queryresults
[0m12:06:29.479058 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:06:27.394093 => 12:06:29.478681
[0m12:06:29.485177 [debug] [Thread-1 (]: Database Error in model dim_vehicle (models/transform/dim_vehicle.sql)
  Syntax error: Expected ")" but got "." at [16:6]
  compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m12:06:29.487474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4071926-4702-4cf8-9cf1-0e531bd40f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df2a2f10>]}
[0m12:06:29.489463 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model retail.dim_vehicle ....................... [[31mERROR[0m in 2.11s]
[0m12:06:29.491466 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:06:29.493219 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:06:29.494728 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m12:06:29.496942 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:06:29.500879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:29.503634 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m12:06:29.505168 [info ] [MainThread]: 
[0m12:06:29.506883 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 11.67 seconds (11.67s).
[0m12:06:29.509567 [debug] [MainThread]: Command end result
[0m12:06:29.535913 [info ] [MainThread]: 
[0m12:06:29.538457 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:06:29.540502 [info ] [MainThread]: 
[0m12:06:29.542423 [error] [MainThread]: [33mDatabase Error in model dim_Weather (models/transform/dim_Weather.sql)[0m
[0m12:06:29.544831 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "Weather_Conditions" at [16:5]
[0m12:06:29.546926 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_Weather.sql
[0m12:06:29.549243 [info ] [MainThread]: 
[0m12:06:29.552300 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m12:06:29.554590 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "Year" at [17:5]
[0m12:06:29.556345 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:06:29.558219 [info ] [MainThread]: 
[0m12:06:29.560445 [error] [MainThread]: [33mDatabase Error in model dim_vehicle (models/transform/dim_vehicle.sql)[0m
[0m12:06:29.562099 [error] [MainThread]:   Syntax error: Expected ")" but got "." at [16:6]
[0m12:06:29.563777 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m12:06:29.567523 [info ] [MainThread]: 
[0m12:06:29.569684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
[0m12:06:29.572314 [debug] [MainThread]: Command `dbt run` failed at 12:06:29.572101 after 13.84 seconds
[0m12:06:29.574225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e1622ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e1a97e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80df3e5210>]}
[0m12:06:29.575934 [debug] [MainThread]: Flushing usage events
[0m12:16:07.598309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d773b3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d77b5c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d773b3890>]}


============================== 12:16:07.601025 | d87f5c3e-748f-4871-8586-83fb4666441c ==============================
[0m12:16:07.601025 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:16:07.603369 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True'}
[0m12:16:08.179176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d755cabd0>]}
[0m12:16:08.201516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d755caf50>]}
[0m12:16:08.203784 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:16:08.229997 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:16:08.350721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:16:08.352586 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_vehicle.sql
[0m12:16:08.354080 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_Weather.sql
[0m12:16:08.355597 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m12:16:08.388198 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m12:16:08.406664 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m12:16:08.413573 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m12:16:08.439201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d75395610>]}
[0m12:16:08.457579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d754c0150>]}
[0m12:16:08.459557 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:16:08.462443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7a964050>]}
[0m12:16:08.465561 [info ] [MainThread]: 
[0m12:16:08.468321 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:08.471337 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:16:08.473594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:09.541869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:16:09.545712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:10.493502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d77a37290>]}
[0m12:16:10.508336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:10.510447 [info ] [MainThread]: 
[0m12:16:10.517086 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:16:10.519994 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:16:10.522579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:16:10.524607 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:16:10.535988 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:16:10.541469 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:16:10.527208 => 12:16:10.540697
[0m12:16:10.543724 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:16:10.593641 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:16:10.599631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:10.603513 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:16:13.978947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:0e2ade4a-5bab-44bf-9ac2-d2a52c8df9f7&page=queryresults
[0m12:16:13.998477 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:16:10.545531 => 12:16:13.998163
[0m12:16:14.001317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d755db3d0>]}
[0m12:16:14.004008 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.48s]
[0m12:16:14.006606 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:16:14.008484 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:16:14.011116 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:16:14.014640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:16:14.017133 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:16:14.022822 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:16:14.026975 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:16:14.018987 => 12:16:14.026606
[0m12:16:14.029736 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:16:14.035998 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:16:14.040810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:14.045139 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    MONTH(Date) AS month,
    Day_of_Week AS week_day,
    DAY(Date) AS day,
    Time AS time
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:16:16.097666 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: MONTH; Did you mean coth? at [27:5]; reason: invalidQuery, location: query, message: Function not found: MONTH; Did you mean coth? at [27:5]')
[0m12:16:18.148059 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:1da6530c-b0a6-4b4b-8cb4-6200de2179ee&page=queryresults
[0m12:16:18.151821 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:16:14.032090 => 12:16:18.151176
[0m12:16:18.160282 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Function not found: MONTH; Did you mean coth? at [27:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:16:18.163025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7444e450>]}
[0m12:16:18.165863 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 4.15s]
[0m12:16:18.168625 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:16:18.170879 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:16:18.172946 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:16:18.174995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:16:18.176431 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:16:18.182754 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:16:18.187794 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:16:18.177770 => 12:16:18.187399
[0m12:16:18.189399 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:16:18.193006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:18.927503 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:16:18.933396 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:16:22.244869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:603ca030-7c8f-4a98-b050-9e2bd3ac2f42&page=queryresults
[0m12:16:22.263607 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:16:18.190653 => 12:16:22.263328
[0m12:16:22.265737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d753ea890>]}
[0m12:16:22.267499 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 4.09s]
[0m12:16:22.269844 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:16:22.271801 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:16:22.273483 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:16:22.276145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:16:22.278531 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:16:22.285085 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:16:22.291396 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:16:22.280188 => 12:16:22.290806
[0m12:16:22.293719 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:16:22.298372 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:16:22.303822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:22.308296 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:16:26.559821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:3654b2d3-ef56-4bf0-bbb0-19cdfdeb58f9&page=queryresults
[0m12:16:26.576141 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:16:22.295115 => 12:16:26.575860
[0m12:16:26.579078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87f5c3e-748f-4871-8586-83fb4666441c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d75528650>]}
[0m12:16:26.581502 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 4.30s]
[0m12:16:26.584093 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:16:26.586858 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:16:26.589096 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m12:16:26.593077 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:16:26.600447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:26.603393 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m12:16:26.605665 [info ] [MainThread]: 
[0m12:16:26.610100 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.14 seconds (18.14s).
[0m12:16:26.615653 [debug] [MainThread]: Command end result
[0m12:16:26.652413 [info ] [MainThread]: 
[0m12:16:26.654501 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:26.656842 [info ] [MainThread]: 
[0m12:16:26.658710 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m12:16:26.660935 [error] [MainThread]:   Function not found: MONTH; Did you mean coth? at [27:5]
[0m12:16:26.663431 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:16:26.665275 [info ] [MainThread]: 
[0m12:16:26.667397 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m12:16:26.669367 [debug] [MainThread]: Command `dbt run` failed at 12:16:26.669163 after 19.09 seconds
[0m12:16:26.670999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d77b5c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d77b52590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7b857010>]}
[0m12:16:26.673150 [debug] [MainThread]: Flushing usage events
[0m12:19:35.327954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444e387710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444e0ab710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444e0ab6d0>]}


============================== 12:19:35.333364 | c8b7a0a9-a5c1-4168-8010-2a422f56dd87 ==============================
[0m12:19:35.333364 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:19:35.338147 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True'}
[0m12:19:35.924103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bc278d0>]}
[0m12:19:35.952896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bc27310>]}
[0m12:19:35.955894 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:19:35.985020 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:19:36.100812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:36.103158 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m12:19:36.134450 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m12:19:36.169654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bc7d6d0>]}
[0m12:19:36.188830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444ba7e750>]}
[0m12:19:36.190886 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:19:36.192982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4451138090>]}
[0m12:19:36.196221 [info ] [MainThread]: 
[0m12:19:36.199142 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:19:36.202742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:19:36.204681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:37.003071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:19:37.005978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:37.616903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444e0abed0>]}
[0m12:19:37.631029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:37.634097 [info ] [MainThread]: 
[0m12:19:37.641379 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:19:37.643575 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:19:37.645880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:19:37.647389 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:19:37.658581 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:19:37.663711 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:19:37.648712 => 12:19:37.663326
[0m12:19:37.665734 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:19:37.686729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:38.464095 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:19:38.471233 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:19:42.013570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:53b70175-a60d-41af-a6bb-c0ac8c6038c1&page=queryresults
[0m12:19:42.036585 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:19:37.668139 => 12:19:42.036314
[0m12:19:42.039953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bc387d0>]}
[0m12:19:42.042026 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.39s]
[0m12:19:42.044332 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:19:42.046273 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:19:42.047896 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:19:42.050365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:19:42.053849 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:19:42.068165 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:19:42.078544 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:19:42.056002 => 12:19:42.077500
[0m12:19:42.080732 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:19:42.086305 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:19:42.091365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:42.095047 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    MONTH(Date) AS month,
    Day_of_Week AS week_day,
    DAY(Date) AS day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:19:43.548192 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: MONTH; Did you mean coth? at [27:5]; reason: invalidQuery, location: query, message: Function not found: MONTH; Did you mean coth? at [27:5]')
[0m12:19:44.991828 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:d90c7c4e-8257-443e-8e33-fdf1954496f7&page=queryresults
[0m12:19:44.995786 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:19:42.082397 => 12:19:44.995280
[0m12:19:45.005185 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Function not found: MONTH; Did you mean coth? at [27:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:19:45.008404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bcbd990>]}
[0m12:19:45.010927 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.96s]
[0m12:19:45.013548 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:19:45.015741 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:19:45.017538 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:19:45.020112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:19:45.022034 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:19:45.029012 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:19:45.033564 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:19:45.024541 => 12:19:45.033114
[0m12:19:45.035425 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:19:45.039781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:45.813220 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:19:45.819569 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:19:49.088943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:f921ace7-6434-437f-a631-97e9744c3dfc&page=queryresults
[0m12:19:49.104484 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:19:45.036847 => 12:19:49.104016
[0m12:19:49.106841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bc27bd0>]}
[0m12:19:49.108875 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 4.09s]
[0m12:19:49.111475 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:19:49.113553 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:19:49.115390 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:19:49.119440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:19:49.121896 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:19:49.129936 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:19:49.134834 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:19:49.123675 => 12:19:49.134408
[0m12:19:49.136800 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:19:49.140550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:49.912349 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:19:49.918881 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:19:52.984875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:3d0897d9-7fd2-45f5-a093-9d8da476bf3c&page=queryresults
[0m12:19:53.002466 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:19:49.138225 => 12:19:53.002195
[0m12:19:53.004497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b7a0a9-a5c1-4168-8010-2a422f56dd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444bc7c810>]}
[0m12:19:53.006701 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 3.89s]
[0m12:19:53.008942 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:19:53.011421 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:19:53.013159 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m12:19:53.015974 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:19:53.020508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:53.022475 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m12:19:53.024249 [info ] [MainThread]: 
[0m12:19:53.026119 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 16.83 seconds (16.83s).
[0m12:19:53.029195 [debug] [MainThread]: Command end result
[0m12:19:53.058462 [info ] [MainThread]: 
[0m12:19:53.060495 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:19:53.063042 [info ] [MainThread]: 
[0m12:19:53.067376 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m12:19:53.069979 [error] [MainThread]:   Function not found: MONTH; Did you mean coth? at [27:5]
[0m12:19:53.072579 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:19:53.074463 [info ] [MainThread]: 
[0m12:19:53.077182 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m12:19:53.079897 [debug] [MainThread]: Command `dbt run` failed at 12:19:53.079391 after 17.78 seconds
[0m12:19:53.082007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444e393490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444e393bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f444df0a650>]}
[0m12:19:53.084322 [debug] [MainThread]: Flushing usage events
[0m12:22:05.251619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00369eb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0034730810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00346ae2d0>]}


============================== 12:22:05.254228 | 74d5149e-afde-48c2-80bf-672ff3f9f576 ==============================
[0m12:22:05.254228 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:22:05.256604 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m12:22:05.866038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003212f5d0>]}
[0m12:22:05.894117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003210ebd0>]}
[0m12:22:05.897044 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:22:05.927979 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:22:06.081900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:22:06.083798 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m12:22:06.085379 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m12:22:06.118561 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:22:06.136652 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m12:22:06.160195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003207f690>]}
[0m12:22:06.179941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0032012750>]}
[0m12:22:06.181970 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:22:06.183857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00374a8050>]}
[0m12:22:06.186792 [info ] [MainThread]: 
[0m12:22:06.189232 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:22:06.192539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:22:06.194945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:06.920301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:22:06.923207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:07.565447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0035158510>]}
[0m12:22:07.579979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:07.581708 [info ] [MainThread]: 
[0m12:22:07.588795 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:22:07.590696 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:22:07.592813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:22:07.594219 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:22:07.604813 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:22:07.609632 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:22:07.595392 => 12:22:07.608906
[0m12:22:07.611104 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:22:07.631295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:08.179861 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:22:08.185126 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:22:11.571452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:1c56ffba-6768-4f6c-b9a7-8abff4ffc81e&page=queryresults
[0m12:22:11.594186 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:22:07.612299 => 12:22:11.593909
[0m12:22:11.596968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003214b490>]}
[0m12:22:11.599211 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.00s]
[0m12:22:11.601946 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:22:11.603809 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:22:11.605419 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:22:11.608402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:22:11.610915 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:22:11.625598 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:22:11.631993 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:22:11.613023 => 12:22:11.631473
[0m12:22:11.634011 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:22:11.639074 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:22:11.645247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:11.649143 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:22:15.518216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:166d8b28-cda6-449c-acad-ef497ab8f40e&page=queryresults
[0m12:22:15.522970 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:22:11.635546 => 12:22:15.522662
[0m12:22:15.525254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0031fa6b90>]}
[0m12:22:15.527365 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 3.92s]
[0m12:22:15.530253 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:22:15.532595 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:22:15.534790 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:22:15.538181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:22:15.540273 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:22:15.546788 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:22:15.551464 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:22:15.541891 => 12:22:15.551079
[0m12:22:15.553020 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:22:15.556738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:16.341290 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:22:16.347582 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:22:19.199684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:932e84cc-60ee-4318-8c17-4000202a5db9&page=queryresults
[0m12:22:19.217222 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:22:15.554350 => 12:22:19.216945
[0m12:22:19.219633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0032115b10>]}
[0m12:22:19.221553 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.68s]
[0m12:22:19.223738 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:22:19.225329 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:22:19.226865 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:22:19.229017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:22:19.231678 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:22:19.238084 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:22:19.242293 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:22:19.233791 => 12:22:19.241731
[0m12:22:19.244055 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:22:19.248978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:20.028090 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:22:20.033374 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:22:23.588355 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:bd1fa9d5-aeff-40c5-8503-049b146ab136&page=queryresults
[0m12:22:23.605670 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:22:19.245605 => 12:22:23.605327
[0m12:22:23.607909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0032173410>]}
[0m12:22:23.609762 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 4.38s]
[0m12:22:23.611985 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:22:23.613745 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:22:23.615551 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:22:23.618211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:22:23.620852 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:22:23.629740 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:22:23.636051 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:22:23.622670 => 12:22:23.635076
[0m12:22:23.639070 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:22:23.645067 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:22:23.650472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:23.655174 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.Day_of_Week,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.Time,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index;
    );
  
[0m12:22:24.629199 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [43:107]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [43:107]')
[0m12:22:25.654858 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:871461fc-dd8e-44f3-9511-51fe7ca0b21c&page=queryresults
[0m12:22:25.658621 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:22:23.641695 => 12:22:25.658118
[0m12:22:25.668492 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Syntax error: Expected ")" but got ";" at [43:107]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:22:25.671918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d5149e-afde-48c2-80bf-672ff3f9f576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0032164950>]}
[0m12:22:25.674207 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 2.05s]
[0m12:22:25.676309 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:22:25.679932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:25.681301 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:22:25.682848 [info ] [MainThread]: 
[0m12:22:25.684519 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.49 seconds (19.49s).
[0m12:22:25.688574 [debug] [MainThread]: Command end result
[0m12:22:25.714163 [info ] [MainThread]: 
[0m12:22:25.716292 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:25.718902 [info ] [MainThread]: 
[0m12:22:25.721601 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:22:25.723459 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [43:107]
[0m12:22:25.725078 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:22:25.727209 [info ] [MainThread]: 
[0m12:22:25.729109 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:22:25.731178 [debug] [MainThread]: Command `dbt run` failed at 12:22:25.731017 after 20.51 seconds
[0m12:22:25.732970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003420d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00346ae250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0034a007d0>]}
[0m12:22:25.734852 [debug] [MainThread]: Flushing usage events
[0m12:24:14.742509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5ed1fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f2acad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f11b650>]}


============================== 12:24:14.745428 | 24a78972-4f60-461c-9917-a4a558257efe ==============================
[0m12:24:14.745428 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:24:14.747731 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True'}
[0m12:24:15.333351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5ef8e850>]}
[0m12:24:15.356894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cae9750>]}
[0m12:24:15.359815 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:24:15.387052 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:24:15.507324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:15.509240 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m12:24:15.542080 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:24:15.576160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cccdf50>]}
[0m12:24:15.594462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c10c6d0>]}
[0m12:24:15.596209 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:24:15.598117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa62008150>]}
[0m12:24:15.601211 [info ] [MainThread]: 
[0m12:24:15.603725 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:24:15.607493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:24:15.610003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:16.559478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:24:16.562327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:17.413457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5fd18750>]}
[0m12:24:17.427476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:17.429504 [info ] [MainThread]: 
[0m12:24:17.435857 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:24:17.438293 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:24:17.441134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:24:17.442682 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:24:17.453814 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:24:17.460215 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:24:17.445017 => 12:24:17.459480
[0m12:24:17.462624 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:24:17.483677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:18.229197 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:24:18.237195 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:24:21.475498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:4a609121-c44b-4e44-b9fe-321194351939&page=queryresults
[0m12:24:21.497686 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:24:17.464486 => 12:24:21.497415
[0m12:24:21.500531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cb8e190>]}
[0m12:24:21.502687 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.06s]
[0m12:24:21.505163 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:24:21.506982 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:24:21.508637 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:24:21.512371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:24:21.515290 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:24:21.535807 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:24:21.543155 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:24:21.517032 => 12:24:21.542376
[0m12:24:21.545141 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:24:21.550728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:22.295177 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:24:22.312617 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:24:25.280702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:00e05b16-9ead-46ae-b07f-42050bafa8f2&page=queryresults
[0m12:24:25.286535 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:24:21.547526 => 12:24:25.286219
[0m12:24:25.289054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cb8d790>]}
[0m12:24:25.291255 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 3.78s]
[0m12:24:25.293761 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:24:25.295922 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:24:25.298539 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:24:25.301846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:24:25.349658 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:24:25.356361 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:24:25.380395 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:24:25.352492 => 12:24:25.379387
[0m12:24:25.382736 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:24:25.388093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:26.201385 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:24:26.208069 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:24:29.248352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:93e67c79-b7ca-41f5-b55b-a25ba30719a0&page=queryresults
[0m12:24:29.265337 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:24:25.384905 => 12:24:29.265054
[0m12:24:29.267478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c9ef790>]}
[0m12:24:29.269244 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.97s]
[0m12:24:29.272082 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:24:29.274229 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:24:29.276629 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:24:29.279806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:24:29.282127 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:24:29.287695 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:24:29.292329 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:24:29.283536 => 12:24:29.291634
[0m12:24:29.294320 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:24:29.298697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:32.495172 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:24:32.512508 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:24:35.095350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:ced58041-bedc-404d-8ae2-81a62e31a9db&page=queryresults
[0m12:24:35.101060 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:24:29.295739 => 12:24:35.100699
[0m12:24:35.103547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cb0d490>]}
[0m12:24:35.105575 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 5.82s]
[0m12:24:35.108485 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:24:35.110882 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:24:35.113393 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:24:35.116590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:24:35.118616 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:24:35.129399 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:24:35.134317 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:24:35.120837 => 12:24:35.133893
[0m12:24:35.137005 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:24:35.142535 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:24:35.146706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:35.150490 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.Day_of_Week,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.Time,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index
    );
  
[0m12:24:37.442450 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Day_of_Week not found inside dt at [16:8]; reason: invalidQuery, location: query, message: Name Day_of_Week not found inside dt at [16:8]')
[0m12:24:38.590048 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:bc52d96a-8756-4913-a85a-9ffe59eb2150&page=queryresults
[0m12:24:38.594244 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:24:35.139206 => 12:24:38.593702
[0m12:24:38.605749 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Name Day_of_Week not found inside dt at [16:8]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:24:38.608884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a78972-4f60-461c-9917-a4a558257efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5ca1d990>]}
[0m12:24:38.611094 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 3.49s]
[0m12:24:38.613644 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:24:38.617805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:38.619599 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:24:38.620934 [info ] [MainThread]: 
[0m12:24:38.623129 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 23.02 seconds (23.02s).
[0m12:24:38.627862 [debug] [MainThread]: Command end result
[0m12:24:38.657934 [info ] [MainThread]: 
[0m12:24:38.660074 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:38.662214 [info ] [MainThread]: 
[0m12:24:38.664342 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:24:38.666236 [error] [MainThread]:   Name Day_of_Week not found inside dt at [16:8]
[0m12:24:38.667900 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:24:38.670153 [info ] [MainThread]: 
[0m12:24:38.672758 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:24:38.675848 [debug] [MainThread]: Command `dbt run` failed at 12:24:38.675676 after 23.97 seconds
[0m12:24:38.677532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f10b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5ef3e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa62e0ffd0>]}
[0m12:24:38.679116 [debug] [MainThread]: Flushing usage events
[0m12:26:33.693706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fbe6d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fb9dd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fbb43690>]}


============================== 12:26:33.696516 | f580c1ee-63ef-4d10-b1c1-78146939a4b0 ==============================
[0m12:26:33.696516 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:26:33.698593 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m12:26:34.269219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f98afd50>]}
[0m12:26:34.292233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f96c8e10>]}
[0m12:26:34.296048 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:26:34.324598 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:26:34.446614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:34.448805 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m12:26:34.490166 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:26:34.524115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f989fc50>]}
[0m12:26:34.544229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f86ee610>]}
[0m12:26:34.546394 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:26:34.548819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7febe8150>]}
[0m12:26:34.552002 [info ] [MainThread]: 
[0m12:26:34.554764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:34.559341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:26:34.561658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:35.205781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:26:35.208524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:35.847316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fc8f8590>]}
[0m12:26:35.861120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:35.863095 [info ] [MainThread]: 
[0m12:26:35.868835 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:26:35.871424 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:26:35.874593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:26:35.876304 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:26:35.886851 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:26:35.891881 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:26:35.877727 => 12:26:35.891467
[0m12:26:35.893730 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:26:35.913359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:36.699200 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:26:36.706564 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:26:39.704795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:efb19d98-f6b4-4d80-a6a3-2856f30526d9&page=queryresults
[0m12:26:39.726728 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:26:35.895251 => 12:26:39.726359
[0m12:26:39.729689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f86ee010>]}
[0m12:26:39.732075 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.86s]
[0m12:26:39.734803 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:26:39.736879 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:26:39.738855 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:26:39.742754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:26:39.744627 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:26:39.758257 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:26:39.763794 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:26:39.745941 => 12:26:39.763355
[0m12:26:39.765692 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:26:39.769718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:40.525706 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:26:40.530921 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:26:43.844110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:6bd26019-eafe-4ce7-9875-fe138f78c81d&page=queryresults
[0m12:26:43.861850 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:26:39.767073 => 12:26:43.861573
[0m12:26:43.863947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f976e690>]}
[0m12:26:43.865792 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 4.12s]
[0m12:26:43.868008 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:26:43.869660 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:26:43.871204 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:26:43.873521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:26:43.875551 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:26:43.881859 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:26:43.886129 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:26:43.878169 => 12:26:43.885775
[0m12:26:43.887658 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:26:43.891187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:44.625821 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:26:44.631010 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:26:47.494352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:a89ceac1-2344-46e6-a823-63a559269068&page=queryresults
[0m12:26:47.500002 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:26:43.888904 => 12:26:47.499687
[0m12:26:47.502651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f98a3fd0>]}
[0m12:26:47.504519 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.63s]
[0m12:26:47.506996 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:26:47.508555 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:26:47.510197 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:26:47.512962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:26:47.515872 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:26:47.522795 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:26:47.527166 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:26:47.518281 => 12:26:47.526713
[0m12:26:47.530086 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:26:47.534976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:48.178243 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:26:48.183950 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:26:53.011299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:bf046f9f-4e77-464f-8b1a-b394d1a7e540&page=queryresults
[0m12:26:53.027574 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:26:47.532438 => 12:26:53.027225
[0m12:26:53.030321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f95c4790>]}
[0m12:26:53.033161 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 5.52s]
[0m12:26:53.036656 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:26:53.039330 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:26:53.041701 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:26:53.044306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:26:53.045957 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:26:53.055559 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:26:53.060596 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:26:53.047576 => 12:26:53.059959
[0m12:26:53.062159 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:26:53.070169 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:26:53.075023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:53.079026 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.Time,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index
    );
  
[0m12:26:54.637738 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Pedestrian_Crossing_Human_Control not found inside ft at [18:8]; reason: invalidQuery, location: query, message: Name Pedestrian_Crossing_Human_Control not found inside ft at [18:8]')
[0m12:26:56.081324 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:63847570-5af6-4814-be7f-a7c0ac7455bd&page=queryresults
[0m12:26:56.097992 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:26:53.063674 => 12:26:56.097540
[0m12:26:56.107390 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Name Pedestrian_Crossing_Human_Control not found inside ft at [18:8]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:26:56.125336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f580c1ee-63ef-4d10-b1c1-78146939a4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f875fbd0>]}
[0m12:26:56.128274 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 3.08s]
[0m12:26:56.131128 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:26:56.135463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:56.137623 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:26:56.139860 [info ] [MainThread]: 
[0m12:26:56.141953 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 21.59 seconds (21.59s).
[0m12:26:56.145709 [debug] [MainThread]: Command end result
[0m12:26:56.172783 [info ] [MainThread]: 
[0m12:26:56.175066 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:26:56.177105 [info ] [MainThread]: 
[0m12:26:56.179574 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:26:56.182201 [error] [MainThread]:   Name Pedestrian_Crossing_Human_Control not found inside ft at [18:8]
[0m12:26:56.184507 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:26:56.188053 [info ] [MainThread]: 
[0m12:26:56.191398 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:26:56.194198 [debug] [MainThread]: Command `dbt run` failed at 12:26:56.194027 after 22.53 seconds
[0m12:26:56.196011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fbfd0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fbb4ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fba429d0>]}
[0m12:26:56.197810 [debug] [MainThread]: Flushing usage events
[0m12:29:51.470272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93406dde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340a08110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340e73010>]}


============================== 12:29:51.473178 | 0ebba2a8-9929-41dd-94ca-340eb41bc98c ==============================
[0m12:29:51.473178 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:29:51.475470 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True'}
[0m12:29:52.060783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933f22ab50>]}
[0m12:29:52.084250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340e98bd0>]}
[0m12:29:52.086715 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:29:52.113502 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:29:52.227327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:52.229192 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m12:29:52.260968 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:29:52.296300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e73ee90>]}
[0m12:29:52.315086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e556510>]}
[0m12:29:52.316893 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:29:52.318640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9343bf7dd0>]}
[0m12:29:52.321641 [info ] [MainThread]: 
[0m12:29:52.324193 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:52.327294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:29:52.329248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:53.053384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:29:53.056163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:53.852763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340b68850>]}
[0m12:29:53.866747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:53.869071 [info ] [MainThread]: 
[0m12:29:53.876076 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:29:53.878356 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:29:53.880697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:29:53.882264 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:29:53.892548 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:29:53.898589 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:29:53.883619 => 12:29:53.898070
[0m12:29:53.900394 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:29:53.919783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:54.721699 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:29:54.726648 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:29:58.557013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:87cd5845-d5c1-41e8-a5aa-81b537877c82&page=queryresults
[0m12:29:58.606259 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:29:53.901849 => 12:29:58.605966
[0m12:29:58.608909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e65f790>]}
[0m12:29:58.611985 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.73s]
[0m12:29:58.615978 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:29:58.629050 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:29:58.631125 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:29:58.634199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:29:58.636431 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:29:58.659055 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:29:58.664581 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:29:58.638112 => 12:29:58.664120
[0m12:29:58.666644 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:29:58.684283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:59.804561 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:29:59.810477 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:30:03.891310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:ef3f15e4-646f-4e44-84a4-6a970573814b&page=queryresults
[0m12:30:03.906944 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:29:58.681647 => 12:30:03.906626
[0m12:30:03.909127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e646190>]}
[0m12:30:03.911153 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 5.28s]
[0m12:30:03.913525 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:30:03.915356 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:30:03.917180 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:30:03.920093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:30:03.921824 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:30:03.926716 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:30:03.933445 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:30:03.923083 => 12:30:03.932613
[0m12:30:03.935590 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:30:03.939573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:04.503528 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:30:04.510419 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:30:07.372195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:21b6d749-0d52-4bd5-ae27-559615a1547f&page=queryresults
[0m12:30:07.378059 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:30:03.936937 => 12:30:07.377690
[0m12:30:07.380436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e751a90>]}
[0m12:30:07.382464 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.46s]
[0m12:30:07.384881 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:30:07.386669 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:30:07.388179 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:30:07.390851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:30:07.393438 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:30:07.399835 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:30:07.404233 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:30:07.395333 => 12:30:07.403907
[0m12:30:07.406325 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:30:07.410010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:08.399081 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:30:08.405788 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:30:11.879909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:502547fa-211c-48aa-bec7-024e176baf84&page=queryresults
[0m12:30:11.897305 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:30:07.407845 => 12:30:11.897027
[0m12:30:11.899653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e6076d0>]}
[0m12:30:11.902209 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 4.51s]
[0m12:30:11.904539 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:30:11.906389 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:30:11.907982 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:30:11.910567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:30:11.912688 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:30:11.922904 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:30:11.931196 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:30:11.914474 => 12:30:11.930676
[0m12:30:11.934288 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:30:11.942486 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:30:11.947508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:11.952883 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing-Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing-Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.Time,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index
    );
  
[0m12:30:13.100108 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Pedestrian_Crossing not found inside ft at [18:8]; reason: invalidQuery, location: query, message: Name Pedestrian_Crossing not found inside ft at [18:8]')
[0m12:30:14.947186 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:3fda3520-414e-4346-8c4b-736f53652508&page=queryresults
[0m12:30:14.962395 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:30:11.937712 => 12:30:14.962001
[0m12:30:14.970270 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Name Pedestrian_Crossing not found inside ft at [18:8]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:30:14.972991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebba2a8-9929-41dd-94ca-340eb41bc98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933e67b2d0>]}
[0m12:30:14.975151 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 3.06s]
[0m12:30:14.977679 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:30:14.981398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:14.983206 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:30:14.984650 [info ] [MainThread]: 
[0m12:30:14.986529 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.66 seconds (22.66s).
[0m12:30:14.991727 [debug] [MainThread]: Command end result
[0m12:30:15.020574 [info ] [MainThread]: 
[0m12:30:15.024011 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:15.026197 [info ] [MainThread]: 
[0m12:30:15.028447 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:30:15.030865 [error] [MainThread]:   Name Pedestrian_Crossing not found inside ft at [18:8]
[0m12:30:15.032811 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:30:15.035174 [info ] [MainThread]: 
[0m12:30:15.037525 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:30:15.040970 [debug] [MainThread]: Command `dbt run` failed at 12:30:15.040692 after 23.61 seconds
[0m12:30:15.042826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340922bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340b50e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340e88cd0>]}
[0m12:30:15.044584 [debug] [MainThread]: Flushing usage events
[0m12:39:41.785340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420b265d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4246a7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff423b94710>]}


============================== 12:39:41.788850 | 9a9488b1-3465-400a-a847-f7e002289894 ==============================
[0m12:39:41.788850 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:39:41.791117 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:39:42.377833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4206eb6d0>]}
[0m12:39:42.400313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4207baad0>]}
[0m12:39:42.403062 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:39:42.430779 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:39:42.547328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:42.549014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:42.556998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420b24dd0>]}
[0m12:39:42.576337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e409fd0>]}
[0m12:39:42.578214 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:39:42.580413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4238a4050>]}
[0m12:39:42.583502 [info ] [MainThread]: 
[0m12:39:42.586349 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:42.590110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:39:42.592940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:43.166691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:39:43.169232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:43.646677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4215a0c10>]}
[0m12:39:43.649278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:43.651308 [info ] [MainThread]: 
[0m12:39:43.657209 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:39:43.660421 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:39:43.663121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:39:43.664816 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:39:43.674809 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:39:43.682017 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:39:43.666111 => 12:39:43.681375
[0m12:39:43.683889 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:39:43.710173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:44.386073 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:39:44.402015 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:39:47.575458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:3fdf8340-323c-428f-a721-ec380b681e6b&page=queryresults
[0m12:39:47.598372 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:39:43.685334 => 12:39:47.598100
[0m12:39:47.601221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e393450>]}
[0m12:39:47.604191 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.94s]
[0m12:39:47.606343 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:39:47.608175 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:39:47.610041 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:39:47.612388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:39:47.614786 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:39:47.620840 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:39:47.625131 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:39:47.616736 => 12:39:47.624727
[0m12:39:47.626750 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:39:47.630409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:48.123473 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:39:48.129578 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:39:50.797445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:091a006f-e140-4e59-a797-d843885d20ed&page=queryresults
[0m12:39:50.817400 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:39:47.628000 => 12:39:50.816739
[0m12:39:50.820292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e3f5090>]}
[0m12:39:50.822286 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 3.21s]
[0m12:39:50.824744 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:39:50.826896 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:39:50.828365 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:39:50.831410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:39:50.834019 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:39:50.838923 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:39:50.844184 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:39:50.835705 => 12:39:50.843868
[0m12:39:50.846062 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:39:50.850735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:51.418125 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:39:51.423985 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:39:54.756265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:75d81245-f804-4eee-9675-8e23db7091c7&page=queryresults
[0m12:39:54.773719 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:39:50.847433 => 12:39:54.773394
[0m12:39:54.775829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e409e50>]}
[0m12:39:54.777731 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.94s]
[0m12:39:54.779785 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:39:54.781523 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:39:54.783017 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:39:54.785217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:39:54.787644 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:39:54.796024 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:39:54.800712 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:39:54.789303 => 12:39:54.800365
[0m12:39:54.802671 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:39:54.808207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:55.503569 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:39:55.509575 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:39:58.449504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:c7c8a1d7-8e64-4940-82c8-787f771c6cb7&page=queryresults
[0m12:39:58.455290 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:39:54.805294 => 12:39:58.454970
[0m12:39:58.457857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e43d1d0>]}
[0m12:39:58.459835 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 3.67s]
[0m12:39:58.462186 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:39:58.464784 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:39:58.466693 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:39:58.469947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:39:58.472257 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:39:58.478853 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:39:58.483204 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:39:58.474206 => 12:39:58.482838
[0m12:39:58.485535 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:39:58.502351 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:39:58.507800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:58.511958 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing-Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing-Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.Time,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index
    );
  
[0m12:39:59.774322 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Pedestrian_Crossing not found inside ft at [18:8]; reason: invalidQuery, location: query, message: Name Pedestrian_Crossing not found inside ft at [18:8]')
[0m12:40:01.312607 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:740c334c-4dc4-4695-bf3a-a97e1171a28e&page=queryresults
[0m12:40:01.316334 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:39:58.487660 => 12:40:01.315953
[0m12:40:01.326127 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Name Pedestrian_Crossing not found inside ft at [18:8]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:40:01.328741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9488b1-3465-400a-a847-f7e002289894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420c2fb50>]}
[0m12:40:01.331681 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 2.86s]
[0m12:40:01.333804 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:40:01.338603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:01.341069 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:40:01.342981 [info ] [MainThread]: 
[0m12:40:01.345007 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.76 seconds (18.76s).
[0m12:40:01.348531 [debug] [MainThread]: Command end result
[0m12:40:01.369345 [info ] [MainThread]: 
[0m12:40:01.372215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:01.374291 [info ] [MainThread]: 
[0m12:40:01.376187 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:40:01.378158 [error] [MainThread]:   Name Pedestrian_Crossing not found inside ft at [18:8]
[0m12:40:01.379931 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:40:01.381712 [info ] [MainThread]: 
[0m12:40:01.383751 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:40:01.386395 [debug] [MainThread]: Command `dbt run` failed at 12:40:01.386207 after 19.64 seconds
[0m12:40:01.388928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420b17c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420371d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420677c90>]}
[0m12:40:01.390783 [debug] [MainThread]: Flushing usage events
[0m12:45:28.104192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d92501d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d92b90810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d92d4c650>]}


============================== 12:45:28.106907 | 48b5c061-53b2-44b7-a62d-2e77df6a34cb ==============================
[0m12:45:28.106907 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:45:28.109542 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m12:45:28.685879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d906f2a90>]}
[0m12:45:28.708110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d906f2a90>]}
[0m12:45:28.710772 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:45:28.738912 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:45:28.849209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:28.851281 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m12:45:28.885198 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:45:28.920089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9076a0d0>]}
[0m12:45:28.938969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d90580310>]}
[0m12:45:28.941331 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:45:28.943467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d95ac8210>]}
[0m12:45:28.946393 [info ] [MainThread]: 
[0m12:45:28.949011 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:45:28.952556 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:45:28.955189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:47.441248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:51:47.445292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:48.467967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d905c2490>]}
[0m12:51:48.470907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:48.473092 [info ] [MainThread]: 
[0m12:51:48.479438 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:51:48.482220 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:51:48.485219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:51:48.486980 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:51:48.497183 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:51:48.505675 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:51:48.488324 => 12:51:48.504342
[0m12:51:48.507999 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:51:48.529017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.314380 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:51:49.320780 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:51:52.362387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:de5b6b1d-c2f9-427f-be66-99d997319a28&page=queryresults
[0m12:51:52.401970 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:51:48.509566 => 12:51:52.401611
[0m12:51:52.404458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d90535750>]}
[0m12:51:52.406548 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.92s]
[0m12:51:52.410118 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:51:52.412094 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:51:52.416652 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:51:52.420724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:51:52.423706 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:51:52.430464 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:51:52.434995 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:51:52.426297 => 12:51:52.434515
[0m12:51:52.436802 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:51:52.448216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:53.390516 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:51:53.397133 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:51:57.048185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:ed18210b-0825-4794-8245-163ebfca2662&page=queryresults
[0m12:51:57.053608 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:51:52.440040 => 12:51:57.053226
[0m12:51:57.056236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d905c3290>]}
[0m12:51:57.058049 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 4.64s]
[0m12:51:57.060212 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:51:57.062224 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:51:57.063885 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:51:57.066419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:51:57.068263 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:51:57.074536 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:51:57.079917 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:51:57.069842 => 12:51:57.079303
[0m12:51:57.081979 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:51:57.086558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:57.869958 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:51:57.876131 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:52:00.737857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:1aa91bc8-f7a9-4ca9-8bf5-e83f63b9aee0&page=queryresults
[0m12:52:00.755934 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:51:57.083383 => 12:52:00.755602
[0m12:52:00.759078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9062cb50>]}
[0m12:52:00.761299 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.69s]
[0m12:52:00.763612 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:52:00.765634 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:52:00.767543 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:52:00.770026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:52:00.772024 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:52:00.790480 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:52:00.797060 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:52:00.773911 => 12:52:00.796616
[0m12:52:00.798875 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:52:00.802920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:01.541273 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:52:01.546968 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:52:04.305518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:17bbd994-5c49-4880-b5ca-989b4f694d61&page=queryresults
[0m12:52:04.310824 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:52:00.800497 => 12:52:04.310470
[0m12:52:04.314311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9050fa90>]}
[0m12:52:04.316359 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 3.54s]
[0m12:52:04.318570 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:52:04.320571 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:52:04.322219 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:52:04.324918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:52:04.328116 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:52:04.335841 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:52:04.341098 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:52:04.330800 => 12:52:04.340613
[0m12:52:04.343827 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:52:04.349475 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:52:04.354319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:04.358289 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.Time,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index
    );
  
[0m12:52:05.800640 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Time not found inside dt at [21:8]; reason: invalidQuery, location: query, message: Name Time not found inside dt at [21:8]')
[0m12:52:07.712387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:73116e13-aa5b-4cb8-80fe-c8fc23d9073b&page=queryresults
[0m12:52:07.716492 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:52:04.346119 => 12:52:07.716074
[0m12:52:07.725962 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Name Time not found inside dt at [21:8]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:52:07.728876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48b5c061-53b2-44b7-a62d-2e77df6a34cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b3f7190>]}
[0m12:52:07.731376 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 3.40s]
[0m12:52:07.733536 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:52:07.737364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:07.738662 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:52:07.740386 [info ] [MainThread]: 
[0m12:52:07.742111 [info ] [MainThread]: Finished running 5 table models in 0 hours 6 minutes and 38.79 seconds (398.79s).
[0m12:52:07.745567 [debug] [MainThread]: Command end result
[0m12:52:07.766860 [info ] [MainThread]: 
[0m12:52:07.769046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:07.771054 [info ] [MainThread]: 
[0m12:52:07.773724 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:52:07.775843 [error] [MainThread]:   Name Time not found inside dt at [21:8]
[0m12:52:07.777542 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:52:07.779938 [info ] [MainThread]: 
[0m12:52:07.783304 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:52:07.785716 [debug] [MainThread]: Command `dbt run` failed at 12:52:07.785516 after 399.99 seconds
[0m12:52:07.787689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d929c3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d92cbdf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d92cb22d0>]}
[0m12:52:07.789387 [debug] [MainThread]: Flushing usage events
[0m12:52:56.073354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425318cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252e9a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252d78c50>]}


============================== 12:52:56.077026 | 1dc1989f-e18d-4876-841a-f8119f17b273 ==============================
[0m12:52:56.077026 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:52:56.079106 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default'}
[0m12:52:56.664341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252e79dd0>]}
[0m12:52:56.687140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42529fdcd0>]}
[0m12:52:56.689798 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:52:56.719201 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:52:56.835560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:56.837400 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m12:52:56.846464 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m12:52:56.879964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252e98fd0>]}
[0m12:52:56.899353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4250864350>]}
[0m12:52:56.900983 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:52:56.902747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4255f07e10>]}
[0m12:52:56.906009 [info ] [MainThread]: 
[0m12:52:56.908922 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:56.912523 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m12:52:56.914729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:57.672866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m12:52:57.675708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:58.501802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4253c24850>]}
[0m12:52:58.516431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:58.519023 [info ] [MainThread]: 
[0m12:52:58.526107 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m12:52:58.528599 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m12:52:58.531492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m12:52:58.533309 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m12:52:58.545960 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m12:52:58.552446 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 12:52:58.535057 => 12:52:58.551978
[0m12:52:58.554176 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m12:52:58.574530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:59.750165 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m12:52:59.755857 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:53:02.589139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:7bc4ce8b-2b24-4a0c-8b52-f5d2fd34729e&page=queryresults
[0m12:53:02.611229 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 12:52:58.555577 => 12:53:02.610964
[0m12:53:02.613901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252fd1110>]}
[0m12:53:02.616106 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.08s]
[0m12:53:02.618688 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m12:53:02.620749 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:53:02.622512 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m12:53:02.625368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m12:53:02.628351 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:53:02.645117 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:53:02.651871 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:53:02.630778 => 12:53:02.650832
[0m12:53:02.654692 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:53:02.659415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:03.422295 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:53:03.437409 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m12:53:06.378627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:143d20bb-e9fc-42b8-906a-e100105843d0&page=queryresults
[0m12:53:06.384063 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:53:02.656371 => 12:53:06.383744
[0m12:53:06.386627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4250a53f90>]}
[0m12:53:06.388758 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 380.6 KiB processed)[0m in 3.76s]
[0m12:53:06.391318 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:53:06.393294 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m12:53:06.395066 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m12:53:06.398001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m12:53:06.402358 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m12:53:06.408229 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m12:53:06.413097 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 12:53:06.404454 => 12:53:06.412489
[0m12:53:06.415195 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m12:53:06.425410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:07.314288 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m12:53:07.320729 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m12:53:10.172396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:df542060-0f42-4470-83b4-4c9eef374763&page=queryresults
[0m12:53:10.190376 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 12:53:06.417093 => 12:53:10.190101
[0m12:53:10.192609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425091e8d0>]}
[0m12:53:10.194627 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.80s]
[0m12:53:10.196866 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m12:53:10.198688 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m12:53:10.200297 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m12:53:10.202827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m12:53:10.205364 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m12:53:10.211115 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m12:53:10.215665 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 12:53:10.206888 => 12:53:10.215296
[0m12:53:10.217512 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m12:53:10.220913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:11.011184 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m12:53:11.018257 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Number_of_Vehicles AS number_vehicle,
    v.make,
    v.Age_of_Vehicle AS vehicle_age
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m12:53:14.476301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:eaa295a6-fdf6-4338-98bf-fb74e684f992&page=queryresults
[0m12:53:14.493612 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 12:53:10.218706 => 12:53:14.493338
[0m12:53:14.496485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42508aae50>]}
[0m12:53:14.499276 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 253.2 KiB processed)[0m in 4.29s]
[0m12:53:14.502387 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m12:53:14.504273 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m12:53:14.506043 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m12:53:14.508786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m12:53:14.514978 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m12:53:14.524137 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m12:53:14.530900 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 12:53:14.516824 => 12:53:14.530343
[0m12:53:14.533413 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m12:53:14.538181 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m12:53:14.543190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:14.547286 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.time_accident,
    dt.Year,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    vd.Number_of_Vehicles AS number_vehicle,
    vd.make AS vehicle_make,
    vd.Age_of_Vehicle AS vehicle_age,
    d.Age_Band_of_Driver AS driver_age_group,
    d.Driver_Home_Area_Type AS driver_home_type,
    d.Sex_of_Driver AS sex,
    ve.Skidding_and_Overturning AS skidding_overturning,
    ve.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`) AS ve ON wc.weatherID = ve.Accident_Index
    );
  
[0m12:53:16.203551 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: vd at [26:5]; reason: invalidQuery, location: query, message: Unrecognized name: vd at [26:5]')
[0m12:53:18.000820 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:9c3cede1-652d-460b-a0bf-40483a534878&page=queryresults
[0m12:53:18.004862 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 12:53:14.534956 => 12:53:18.004332
[0m12:53:18.014792 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Unrecognized name: vd at [26:5]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:53:18.017148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc1989f-e18d-4876-841a-f8119f17b273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4250890750>]}
[0m12:53:18.019255 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 3.51s]
[0m12:53:18.021484 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m12:53:18.025004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:18.026752 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m12:53:18.029541 [info ] [MainThread]: 
[0m12:53:18.036322 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 21.12 seconds (21.12s).
[0m12:53:18.041083 [debug] [MainThread]: Command end result
[0m12:53:18.071351 [info ] [MainThread]: 
[0m12:53:18.073800 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:18.075652 [info ] [MainThread]: 
[0m12:53:18.077467 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m12:53:18.080565 [error] [MainThread]:   Unrecognized name: vd at [26:5]
[0m12:53:18.082476 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m12:53:18.084658 [info ] [MainThread]: 
[0m12:53:18.087126 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:53:18.089634 [debug] [MainThread]: Command `dbt run` failed at 12:53:18.089425 after 22.07 seconds
[0m12:53:18.091534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252d72b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425371a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425314fb50>]}
[0m12:53:18.093361 [debug] [MainThread]: Flushing usage events
[0m14:15:29.202718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddffcad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de0737190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddffdeed0>]}


============================== 14:15:29.206194 | f3cdd597-e84a-48d3-ba7c-a9b99445c174 ==============================
[0m14:15:29.206194 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:15:29.208735 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'target_path': 'None'}
[0m14:15:29.787030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de1c5fe10>]}
[0m14:15:29.809337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dde025ad0>]}
[0m14:15:29.812031 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:15:29.841954 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:15:29.980665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:15:29.982517 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:15:29.983888 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m14:15:29.985173 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_vehicle.sql
[0m14:15:30.016972 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m14:15:30.035523 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m14:15:30.042770 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m14:15:30.066065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dde025790>]}
[0m14:15:30.090520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dddf01390>]}
[0m14:15:30.092482 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:15:30.094780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de3510050>]}
[0m14:15:30.097615 [info ] [MainThread]: 
[0m14:15:30.100614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:15:30.106553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:15:30.108776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:31.006673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:15:31.009394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:31.984403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de1208550>]}
[0m14:15:31.999140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:32.001560 [info ] [MainThread]: 
[0m14:15:32.007707 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:15:32.010548 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:15:32.014004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:15:32.015991 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:15:32.026432 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:15:32.035831 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:15:32.017943 => 14:15:32.035422
[0m14:15:32.037613 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:15:32.057697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:32.836963 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:15:32.845449 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:15:35.669951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:5281ebc0-5796-474b-971a-ed6a2451b2f8&page=queryresults
[0m14:15:35.692163 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:15:32.039024 => 14:15:35.691889
[0m14:15:35.695185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dde0caf50>]}
[0m14:15:35.697794 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.68s]
[0m14:15:35.700693 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:15:35.702535 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:15:35.704197 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:15:35.707816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:15:35.710492 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:15:35.716408 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:15:35.723042 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:15:35.712296 => 14:15:35.722659
[0m14:15:35.724882 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:15:35.729008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:36.492706 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:15:36.510111 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS dates
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:15:36.920234 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword TIME at [29:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword TIME at [29:5]')
[0m14:15:37.658444 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:b8e9ec61-35e9-420a-9a2e-a6cd6343eac6&page=queryresults
[0m14:15:37.662969 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:15:35.726411 => 14:15:37.662487
[0m14:15:37.673700 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got keyword TIME at [29:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:15:37.676125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dde090690>]}
[0m14:15:37.678316 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 1.97s]
[0m14:15:37.680689 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:15:37.682501 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:15:37.685500 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:15:37.693512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:15:37.697175 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:15:37.704302 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:15:37.709916 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:15:37.699133 => 14:15:37.709486
[0m14:15:37.711733 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:15:37.715579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:38.538577 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:15:38.544811 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:15:42.031791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:628358e1-8605-4564-869f-5967a40fe0df&page=queryresults
[0m14:15:42.047842 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:15:37.713127 => 14:15:42.047582
[0m14:15:42.049840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddcf32850>]}
[0m14:15:42.051676 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 4.36s]
[0m14:15:42.053820 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:15:42.055536 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:15:42.057171 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:15:42.059758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:15:42.062676 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:15:42.069737 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:15:42.076778 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:15:42.065124 => 14:15:42.076366
[0m14:15:42.078744 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:15:42.082637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:42.845081 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:15:42.852170 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID
    a.Number_of_Vehicles AS number_vehicle,
    v.make AS vehicle_make,
    v.Age_of_Vehicle as vehicle_aga,
    v.Skidding_and_Overturning AS skidding_overturning,
    v.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m14:15:43.253959 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "a" at [22:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "a" at [22:5]')
[0m14:15:44.483016 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:3c69a6bf-ff73-4069-80df-11d9ad28e2b2&page=queryresults
[0m14:15:44.487062 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:15:42.080361 => 14:15:44.486614
[0m14:15:44.494327 [debug] [Thread-1 (]: Database Error in model dim_vehicle (models/transform/dim_vehicle.sql)
  Syntax error: Expected ")" but got identifier "a" at [22:5]
  compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m14:15:44.497432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cdd597-e84a-48d3-ba7c-a9b99445c174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dddfffd10>]}
[0m14:15:44.499246 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model retail.dim_vehicle ....................... [[31mERROR[0m in 2.44s]
[0m14:15:44.501313 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:15:44.503889 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:15:44.505577 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m14:15:44.507748 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:15:44.513453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:44.515353 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m14:15:44.517099 [info ] [MainThread]: 
[0m14:15:44.519123 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.42 seconds (14.42s).
[0m14:15:44.522097 [debug] [MainThread]: Command end result
[0m14:15:44.552065 [info ] [MainThread]: 
[0m14:15:44.554116 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:15:44.555832 [info ] [MainThread]: 
[0m14:15:44.557709 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m14:15:44.559830 [error] [MainThread]:   Syntax error: Expected ")" but got keyword TIME at [29:5]
[0m14:15:44.562030 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:15:44.564087 [info ] [MainThread]: 
[0m14:15:44.566119 [error] [MainThread]: [33mDatabase Error in model dim_vehicle (models/transform/dim_vehicle.sql)[0m
[0m14:15:44.567910 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "a" at [22:5]
[0m14:15:44.569607 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m14:15:44.571695 [info ] [MainThread]: 
[0m14:15:44.573570 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m14:15:44.577018 [debug] [MainThread]: Command `dbt run` failed at 14:15:44.576668 after 15.39 seconds
[0m14:15:44.579695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de089f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de05fd7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de0781f90>]}
[0m14:15:44.581869 [debug] [MainThread]: Flushing usage events
[0m14:16:57.343247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe9100ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe8e08290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe8fcc810>]}


============================== 14:16:57.346771 | 5cdac989-db3e-4f04-be98-e55ac41b3371 ==============================
[0m14:16:57.346771 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:16:57.348858 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m14:16:57.937877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe6b59950>]}
[0m14:16:57.961313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe6b74190>]}
[0m14:16:57.963992 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:16:57.999225 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:16:58.138200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:16:58.140143 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m14:16:58.141785 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:16:58.174752 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m14:16:58.192531 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m14:16:58.216745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe6b7eb10>]}
[0m14:16:58.235284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe6a5a950>]}
[0m14:16:58.237222 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:16:58.238822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effebf00210>]}
[0m14:16:58.241878 [info ] [MainThread]: 
[0m14:16:58.244740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:16:58.247821 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:16:58.249451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:58.984012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:16:58.986737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:59.842296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe88483d0>]}
[0m14:16:59.856742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:59.859017 [info ] [MainThread]: 
[0m14:16:59.864865 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:16:59.868035 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:16:59.870834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:16:59.872741 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:16:59.883893 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:16:59.888484 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:16:59.875005 => 14:16:59.888047
[0m14:16:59.890647 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:16:59.911822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:00.895625 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:17:00.900626 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:17:03.941902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:9197c813-3055-4295-9ad9-e646e8d3a4a8&page=queryresults
[0m14:17:03.964876 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:16:59.892646 => 14:17:03.964606
[0m14:17:03.967404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe6ac0cd0>]}
[0m14:17:03.969676 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.10s]
[0m14:17:03.971973 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:17:03.973923 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:17:03.975622 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:17:03.978401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:17:03.981015 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:17:03.996281 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:17:04.002048 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:17:03.983189 => 14:17:04.001681
[0m14:17:04.003884 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:17:04.007875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:04.690273 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:17:04.707801 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS accident_date
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:17:05.005135 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword TIME at [29:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword TIME at [29:5]')
[0m14:17:06.625387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:67657c18-77b6-4ecf-8a59-776935400d37&page=queryresults
[0m14:17:06.629712 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:17:04.005467 => 14:17:06.629266
[0m14:17:06.639235 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got keyword TIME at [29:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:17:06.641461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe69fde10>]}
[0m14:17:06.643657 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.66s]
[0m14:17:06.647114 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:17:06.649921 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:17:06.653489 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:17:06.656060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:17:06.659822 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:17:06.670783 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:17:06.676722 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:17:06.667032 => 14:17:06.676217
[0m14:17:06.678944 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:17:06.685258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:07.423010 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:17:07.428821 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:17:10.296602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:c3662d09-eb63-4f29-816d-00e8190facfd&page=queryresults
[0m14:17:10.314368 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:17:06.682204 => 14:17:10.314021
[0m14:17:10.316727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe6baff90>]}
[0m14:17:10.318642 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.66s]
[0m14:17:10.321019 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:17:10.322825 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:17:10.324576 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:17:10.327582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:17:10.330219 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:17:10.338844 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:17:10.344114 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:17:10.332734 => 14:17:10.343600
[0m14:17:10.346243 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:17:10.352154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:11.110862 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:17:11.116906 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID
    a.Number_of_Vehicles AS number_vehicle,
    v.make AS vehicle_make,
    v.Age_of_Vehicle as vehicle_aga,
    v.Skidding_and_Overturning AS skidding_overturning,
    v.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.Accident_Index = v.Accident_Index
    );
  
[0m14:17:11.519837 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "a" at [22:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "a" at [22:5]')
[0m14:17:12.543662 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:413ad812-71f5-4d9a-8532-a71059321704&page=queryresults
[0m14:17:12.546233 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:17:10.348478 => 14:17:12.545939
[0m14:17:12.552493 [debug] [Thread-1 (]: Database Error in model dim_vehicle (models/transform/dim_vehicle.sql)
  Syntax error: Expected ")" but got identifier "a" at [22:5]
  compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m14:17:12.554620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cdac989-db3e-4f04-be98-e55ac41b3371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe59de750>]}
[0m14:17:12.556725 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model retail.dim_vehicle ....................... [[31mERROR[0m in 2.23s]
[0m14:17:12.559545 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:17:12.562054 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:17:12.563521 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m14:17:12.566662 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:17:12.571195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:12.574040 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m14:17:12.575711 [info ] [MainThread]: 
[0m14:17:12.577688 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.33 seconds (14.33s).
[0m14:17:12.580719 [debug] [MainThread]: Command end result
[0m14:17:12.616461 [info ] [MainThread]: 
[0m14:17:12.619525 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:17:12.622150 [info ] [MainThread]: 
[0m14:17:12.624261 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m14:17:12.626367 [error] [MainThread]:   Syntax error: Expected ")" but got keyword TIME at [29:5]
[0m14:17:12.627991 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:17:12.630756 [info ] [MainThread]: 
[0m14:17:12.632512 [error] [MainThread]: [33mDatabase Error in model dim_vehicle (models/transform/dim_vehicle.sql)[0m
[0m14:17:12.634540 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "a" at [22:5]
[0m14:17:12.637048 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m14:17:12.641031 [info ] [MainThread]: 
[0m14:17:12.643270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m14:17:12.646017 [debug] [MainThread]: Command `dbt run` failed at 14:17:12.645835 after 15.32 seconds
[0m14:17:12.647788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe8e53c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe9102d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe9103cd0>]}
[0m14:17:12.649612 [debug] [MainThread]: Flushing usage events
[0m14:25:09.734646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c440cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43f18cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43f2ab50>]}


============================== 14:25:09.738221 | d1b6f0d3-25e3-4e21-9a14-42a942444140 ==============================
[0m14:25:09.738221 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:25:09.740375 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m14:25:10.315347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c41977d10>]}
[0m14:25:10.338364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c41974d10>]}
[0m14:25:10.341249 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:25:10.368593 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:25:10.482342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:25:10.484254 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:25:10.485670 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m14:25:10.487131 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_vehicle.sql
[0m14:25:10.519058 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m14:25:10.537453 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m14:25:10.544485 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m14:25:10.565775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c419a5690>]}
[0m14:25:10.587101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c41870b90>]}
[0m14:25:10.589037 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:25:10.591421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c46d14250>]}
[0m14:25:10.594247 [info ] [MainThread]: 
[0m14:25:10.596386 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:25:10.600157 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:25:10.602597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:11.463539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:25:11.465948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:12.286695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c418a9c90>]}
[0m14:25:12.301079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:12.303388 [info ] [MainThread]: 
[0m14:25:12.312439 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:25:12.314809 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:25:12.316997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:25:12.318478 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:25:12.328466 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:25:12.332664 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:25:12.319636 => 14:25:12.332043
[0m14:25:12.333968 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:25:12.352665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.139250 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:25:13.144365 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:25:16.074349 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:78c3c133-c34b-4434-97ff-4475b4f3c575&page=queryresults
[0m14:25:16.097634 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:25:12.335024 => 14:25:16.097354
[0m14:25:16.100603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4184af10>]}
[0m14:25:16.103159 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.78s]
[0m14:25:16.106253 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:25:16.108470 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:25:16.110888 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:25:16.113120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:25:16.114828 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:25:16.120385 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:25:16.126932 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:25:16.116320 => 14:25:16.126272
[0m14:25:16.129379 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:25:16.134872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:16.893815 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:25:16.909649 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL

SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS accident_date
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:25:17.304733 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword TIME at [30:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword TIME at [30:5]')
[0m14:25:18.225829 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:cbde2109-92d4-489f-a7c1-5360b2e86e2b&page=queryresults
[0m14:25:18.229384 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:25:16.131145 => 14:25:18.229001
[0m14:25:18.237967 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got keyword TIME at [30:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:25:18.240302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c419c6c50>]}
[0m14:25:18.242179 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.13s]
[0m14:25:18.244621 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:25:18.247478 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:25:18.250165 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:25:18.252293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:25:18.253866 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:25:18.258898 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:25:18.265392 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:25:18.255317 => 14:25:18.265004
[0m14:25:18.267309 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:25:18.271379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:19.046429 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:25:19.051619 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:25:22.223141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:2d029aba-fda5-4da8-b414-c018df1840c1&page=queryresults
[0m14:25:22.240643 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:25:18.268998 => 14:25:22.240373
[0m14:25:22.242808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4188ebd0>]}
[0m14:25:22.244646 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.99s]
[0m14:25:22.247036 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:25:22.248690 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:25:22.250276 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:25:22.253508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:25:22.256183 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:25:22.262304 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:25:22.267314 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:25:22.257948 => 14:25:22.266686
[0m14:25:22.269875 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:25:22.273650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:23.049851 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:25:23.056098 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID
    a.Number_of_Vehicles AS number_vehicle,
    v.make AS vehicle_make,
    v.Age_of_Vehicle as vehicle_aga,
    v.Skidding_and_Overturning AS skidding_overturning,
    v.X1st_Point_of_Impact AS first_Point_Impact
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v 
ON 
    a.vehicleID = v.Accident_Index
    );
  
[0m14:25:23.350700 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "a" at [22:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "a" at [22:5]')
[0m14:25:24.663277 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:569c1aa8-187d-4b1e-8df7-406b4d85ad42&page=queryresults
[0m14:25:24.666818 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:25:22.271353 => 14:25:24.666391
[0m14:25:24.673580 [debug] [Thread-1 (]: Database Error in model dim_vehicle (models/transform/dim_vehicle.sql)
  Syntax error: Expected ")" but got identifier "a" at [22:5]
  compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m14:25:24.676387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b6f0d3-25e3-4e21-9a14-42a942444140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c406f1f50>]}
[0m14:25:24.679274 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model retail.dim_vehicle ....................... [[31mERROR[0m in 2.42s]
[0m14:25:24.681653 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:25:24.684742 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:25:24.686705 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m14:25:24.688799 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:25:24.692759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:24.694923 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m14:25:24.700740 [info ] [MainThread]: 
[0m14:25:24.703834 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m14:25:24.707825 [debug] [MainThread]: Command end result
[0m14:25:24.737988 [info ] [MainThread]: 
[0m14:25:24.740226 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:25:24.742414 [info ] [MainThread]: 
[0m14:25:24.745270 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m14:25:24.748364 [error] [MainThread]:   Syntax error: Expected ")" but got keyword TIME at [30:5]
[0m14:25:24.750489 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:25:24.752215 [info ] [MainThread]: 
[0m14:25:24.753909 [error] [MainThread]: [33mDatabase Error in model dim_vehicle (models/transform/dim_vehicle.sql)[0m
[0m14:25:24.755981 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "a" at [22:5]
[0m14:25:24.757721 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_vehicle.sql
[0m14:25:24.759405 [info ] [MainThread]: 
[0m14:25:24.762431 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m14:25:24.765506 [debug] [MainThread]: Command `dbt run` failed at 14:25:24.765324 after 15.07 seconds
[0m14:25:24.767414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43db3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43f29890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43c79890>]}
[0m14:25:24.769113 [debug] [MainThread]: Flushing usage events
[0m14:28:42.303959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d453b55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d453c0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d490d1dd0>]}


============================== 14:28:42.306672 | 8fc7f1e1-143a-487a-ac73-862a0c281cff ==============================
[0m14:28:42.306672 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:28:42.309172 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'partial_parse': 'True'}
[0m14:28:42.894944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42e12450>]}
[0m14:28:42.918155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42e10990>]}
[0m14:28:42.921041 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:28:42.947125 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:28:43.075703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:43.077622 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_vehicle.sql
[0m14:28:43.112519 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m14:28:43.148598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42e10290>]}
[0m14:28:43.168977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d41c4c550>]}
[0m14:28:43.171633 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:28:43.173744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d48148150>]}
[0m14:28:43.176468 [info ] [MainThread]: 
[0m14:28:43.179046 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:28:43.183031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:28:43.187643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:44.069265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:28:44.071673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:44.768638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d45e58690>]}
[0m14:28:44.783008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:44.785057 [info ] [MainThread]: 
[0m14:28:44.790806 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:28:44.793633 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:28:44.796136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:28:44.797721 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:28:44.809259 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:28:44.813966 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:28:44.799116 => 14:28:44.813462
[0m14:28:44.815694 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:28:44.837404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:45.611995 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:28:45.618087 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:28:48.760857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:edf6e02f-4fcb-4bce-b28c-51eb4d46e68d&page=queryresults
[0m14:28:48.792817 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:28:44.816950 => 14:28:48.792513
[0m14:28:48.796826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42d0ef90>]}
[0m14:28:48.808377 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.00s]
[0m14:28:48.811570 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:28:48.814128 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:28:48.816684 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:28:48.819776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:28:48.822673 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:28:48.847559 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:28:48.854374 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:28:48.825271 => 14:28:48.853660
[0m14:28:48.858239 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:28:48.863929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:49.551527 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:28:49.570464 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL

SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS accident_date
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:28:49.887342 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword TIME at [30:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword TIME at [30:5]')
[0m14:28:51.118541 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:45fec606-5bde-466d-ad57-655a425b3646&page=queryresults
[0m14:28:51.122536 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:28:48.860545 => 14:28:51.122145
[0m14:28:51.132290 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got keyword TIME at [30:5]
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:28:51.134762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42c3fa90>]}
[0m14:28:51.136811 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.32s]
[0m14:28:51.138705 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:28:51.140318 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:28:51.143029 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:28:51.145902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:28:51.148079 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:28:51.153842 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:28:51.159282 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:28:51.149658 => 14:28:51.158583
[0m14:28:51.161449 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:28:51.165551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:51.939723 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:28:51.945809 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:28:55.095731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:5b90bd6c-bd45-490e-88d3-4c09ef79af79&page=queryresults
[0m14:28:55.111690 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:28:51.163173 => 14:28:55.111429
[0m14:28:55.113702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42c3e210>]}
[0m14:28:55.115561 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.97s]
[0m14:28:55.117696 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:28:55.119444 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:28:55.121310 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:28:55.125293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:28:55.127821 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:28:55.134467 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:28:55.139185 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:28:55.129866 => 14:28:55.138586
[0m14:28:55.141583 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:28:55.145465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:55.913093 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:28:55.919759 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID,  -- Selecting and aliasing the Accident_Index column as vehicleID
    a.Number_of_Vehicles AS number_vehicle,  -- Selecting the Number_of_Vehicles column
    v.make AS vehicle_make,  -- Selecting the make column from the vehicle_data table and aliasing it as vehicle_make
    v.Age_of_Vehicle as vehicle_aga,  -- Selecting the Age_of_Vehicle column and aliasing it as vehicle_aga
    v.Skidding_and_Overturning AS skidding_overturning,  -- Selecting the Skidding_and_Overturning column
    v.X1st_Point_of_Impact AS first_Point_Impact  -- Selecting the X1st_Point_of_Impact column
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a  -- Selecting data from the traffic_data table and aliasing it as 'a'
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v  -- Selecting data from the vehicle_data table and aliasing it as 'v'
ON 
    a.Accident_Index = v.Accident_Index  -- Joining the two tables based on the Accident_Index column
    );
  
[0m14:28:59.303074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:8bb53a7f-d1a3-4311-9bc4-55f67c41c933&page=queryresults
[0m14:28:59.309878 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:28:55.143110 => 14:28:59.309511
[0m14:28:59.312649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc7f1e1-143a-487a-ac73-862a0c281cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d42c4dcd0>]}
[0m14:28:59.314755 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 272.3 KiB processed)[0m in 4.19s]
[0m14:28:59.316808 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:28:59.319558 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:28:59.321013 [info ] [Thread-1 (]: 5 of 5 SKIP relation retail.fct_trafic ......................................... [[33mSKIP[0m]
[0m14:28:59.323385 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:28:59.328487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:59.331434 [debug] [MainThread]: Connection 'model.retail.dim_vehicle' was properly closed.
[0m14:28:59.333550 [info ] [MainThread]: 
[0m14:28:59.335601 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 16.15 seconds (16.15s).
[0m14:28:59.338763 [debug] [MainThread]: Command end result
[0m14:28:59.368232 [info ] [MainThread]: 
[0m14:28:59.370121 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:28:59.372017 [info ] [MainThread]: 
[0m14:28:59.373702 [error] [MainThread]: [33mDatabase Error in model dim_datetime (models/transform/dim_datetime.sql)[0m
[0m14:28:59.376195 [error] [MainThread]:   Syntax error: Expected ")" but got keyword TIME at [30:5]
[0m14:28:59.379257 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:28:59.381463 [info ] [MainThread]: 
[0m14:28:59.383557 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m14:28:59.385635 [debug] [MainThread]: Command `dbt run` failed at 14:28:59.385475 after 17.12 seconds
[0m14:28:59.387481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d453aad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d450d3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d45073510>]}
[0m14:28:59.389860 [debug] [MainThread]: Flushing usage events
[0m14:30:53.216944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807c867710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807c864bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807cb77150>]}


============================== 14:30:53.220637 | d10e92c1-1fe1-49b6-95fc-d94827a5556b ==============================
[0m14:30:53.220637 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:30:53.222714 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m14:30:53.803032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a43d950>]}
[0m14:30:53.826312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a417c10>]}
[0m14:30:53.829602 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:30:53.859110 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:30:53.994487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:30:53.996194 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:30:54.027280 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m14:30:54.064381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a453650>]}
[0m14:30:54.082824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a26e590>]}
[0m14:30:54.084745 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:30:54.086774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807f928050>]}
[0m14:30:54.089796 [info ] [MainThread]: 
[0m14:30:54.092207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:54.095561 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:30:54.097480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:55.001873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:30:55.004721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:55.825937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807cb82650>]}
[0m14:30:55.839746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:55.841682 [info ] [MainThread]: 
[0m14:30:55.847655 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:30:55.850022 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:30:55.852257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:30:55.853899 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:30:55.864847 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:30:55.869634 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:30:55.856026 => 14:30:55.869126
[0m14:30:55.872152 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:30:55.893781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:56.672821 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:30:56.678308 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:31:00.538779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:4739cee2-b6bd-4909-a737-0b5ccfa5c31b&page=queryresults
[0m14:31:00.581021 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:30:55.874114 => 14:31:00.580593
[0m14:31:00.585033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a221310>]}
[0m14:31:00.588981 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.73s]
[0m14:31:00.594187 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:31:00.598471 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:31:00.602661 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:31:00.605505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:31:00.607565 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:31:00.627937 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:31:00.634825 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:31:00.610308 => 14:31:00.633974
[0m14:31:00.637869 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:31:00.644443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:01.357662 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:31:01.363671 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL

SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS accident_date,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:31:04.224883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:196e95c9-06e8-40c9-9de3-3f3ec5d6986b&page=queryresults
[0m14:31:04.230211 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:31:00.639797 => 14:31:04.229892
[0m14:31:04.233001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a4cd610>]}
[0m14:31:04.235215 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 497.8 KiB processed)[0m in 3.63s]
[0m14:31:04.237782 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:31:04.239597 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:31:04.241485 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:31:04.244750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:31:04.247539 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:31:04.253000 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:31:04.257586 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:31:04.249566 => 14:31:04.257124
[0m14:31:04.259148 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:31:04.265647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:05.046107 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:31:05.053141 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:31:07.914280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:b9f94a55-b0e0-402e-b516-9c5d8e487219&page=queryresults
[0m14:31:07.932294 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:31:04.260565 => 14:31:07.931878
[0m14:31:07.934967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a221910>]}
[0m14:31:07.936851 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.69s]
[0m14:31:07.939629 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:31:07.941398 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:31:07.943049 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:31:07.946148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:31:07.949403 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:31:07.955579 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:31:07.959855 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:31:07.951186 => 14:31:07.959541
[0m14:31:07.961759 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:31:07.966234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:08.735665 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:31:08.741891 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID,  -- Selecting and aliasing the Accident_Index column as vehicleID
    a.Number_of_Vehicles AS number_vehicle,  -- Selecting the Number_of_Vehicles column
    v.make AS vehicle_make,  -- Selecting the make column from the vehicle_data table and aliasing it as vehicle_make
    v.Age_of_Vehicle as vehicle_aga,  -- Selecting the Age_of_Vehicle column and aliasing it as vehicle_aga
    v.Skidding_and_Overturning AS skidding_overturning,  -- Selecting the Skidding_and_Overturning column
    v.X1st_Point_of_Impact AS first_Point_Impact  -- Selecting the X1st_Point_of_Impact column
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a  -- Selecting data from the traffic_data table and aliasing it as 'a'
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v  -- Selecting data from the vehicle_data table and aliasing it as 'v'
ON 
    a.Accident_Index = v.Accident_Index  -- Joining the two tables based on the Accident_Index column
    );
  
[0m14:31:11.806599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:903957b1-99ec-479b-9855-86a15cf5f127&page=queryresults
[0m14:31:11.828114 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:31:07.963198 => 14:31:11.827785
[0m14:31:11.830635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a4cda50>]}
[0m14:31:11.832772 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 272.3 KiB processed)[0m in 3.88s]
[0m14:31:11.835627 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:31:11.838701 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:31:11.841338 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m14:31:11.844061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m14:31:11.845725 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m14:31:11.855338 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m14:31:11.861957 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 14:31:11.847129 => 14:31:11.861556
[0m14:31:11.863679 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m14:31:11.868516 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m14:31:11.874742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:11.878686 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ve.number_vehicle,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.time_accident,
    dt.year,
    dt.dates
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    ve.vehicle_make,
    ve.vehicle_aga,
    d.driver_age_group,
    d.driver_home_type,
    d.sex,
    ve.skidding_overturning,
    ve.first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_vehicle`) AS ve ON wc.weatherID = ve.vehicleID
    );
  
[0m14:31:12.834311 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "." at [25:7]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "." at [25:7]')
[0m14:31:14.267212 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:dbccb1b9-b29d-453e-bd89-b41bf44f6618&page=queryresults
[0m14:31:14.270872 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 14:31:11.865076 => 14:31:14.270453
[0m14:31:14.279456 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Syntax error: Expected ")" but got "." at [25:7]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m14:31:14.281665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd10e92c1-1fe1-49b6-95fc-d94827a5556b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807a2d62d0>]}
[0m14:31:14.283574 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 2.44s]
[0m14:31:14.285599 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:31:14.291039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:14.292748 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m14:31:14.294402 [info ] [MainThread]: 
[0m14:31:14.296475 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 20.20 seconds (20.20s).
[0m14:31:14.299629 [debug] [MainThread]: Command end result
[0m14:31:14.327664 [info ] [MainThread]: 
[0m14:31:14.330066 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:31:14.332146 [info ] [MainThread]: 
[0m14:31:14.334068 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m14:31:14.336404 [error] [MainThread]:   Syntax error: Expected ")" but got "." at [25:7]
[0m14:31:14.339367 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m14:31:14.341574 [info ] [MainThread]: 
[0m14:31:14.343895 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:31:14.345866 [debug] [MainThread]: Command `dbt run` failed at 14:31:14.345706 after 21.14 seconds
[0m14:31:14.347493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807c76f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807cb77090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807c70a310>]}
[0m14:31:14.349063 [debug] [MainThread]: Flushing usage events
[0m14:33:10.025037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d928050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d92a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d9529d0>]}


============================== 14:33:10.027808 | f883caa2-5a65-4083-9160-c28001233921 ==============================
[0m14:33:10.027808 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:33:10.030385 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m14:33:10.600213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b1a7250>]}
[0m14:33:10.622870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d0a5450>]}
[0m14:33:10.625447 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:33:10.652769 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:33:10.776725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:10.778557 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m14:33:10.811654 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m14:33:10.846256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b1fb710>]}
[0m14:33:10.866313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b00c250>]}
[0m14:33:10.868838 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:33:10.870946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95506afe50>]}
[0m14:33:10.874301 [info ] [MainThread]: 
[0m14:33:10.877254 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:10.884174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:33:10.887649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:11.648244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:33:11.650809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:12.440195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d63df10>]}
[0m14:33:12.454895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:12.457101 [info ] [MainThread]: 
[0m14:33:12.462736 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:33:12.464908 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:33:12.467375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:33:12.469730 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:33:12.480835 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:33:12.486772 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:33:12.472098 => 14:33:12.486131
[0m14:33:12.488897 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:33:12.508853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:13.284253 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:33:13.289429 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:33:16.217441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:ddc1f91d-84ff-41be-95d5-168f69ef8d61&page=queryresults
[0m14:33:16.240116 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:33:12.490616 => 14:33:16.239847
[0m14:33:16.243050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d652850>]}
[0m14:33:16.245924 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 3.78s]
[0m14:33:16.248240 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:33:16.250059 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:33:16.251888 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:33:16.254563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:33:16.257426 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:33:16.271976 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:33:16.279117 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:33:16.259782 => 14:33:16.278635
[0m14:33:16.281799 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:33:16.285884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:17.149257 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:33:17.166428 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL

SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS accident_date,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:33:20.017581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:a337d4c9-cde5-42ee-8aad-f94b06708ad5&page=queryresults
[0m14:33:20.023041 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:33:16.283343 => 14:33:20.022717
[0m14:33:20.025297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b218450>]}
[0m14:33:20.027341 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 497.8 KiB processed)[0m in 3.77s]
[0m14:33:20.029879 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:33:20.031764 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:33:20.033558 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:33:20.036759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:33:20.039094 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:33:20.046579 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:33:20.051391 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:33:20.042410 => 14:33:20.051047
[0m14:33:20.053131 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:33:20.058091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:20.840453 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:33:20.846152 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:33:23.553914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:f629583e-52ac-4b59-b6ba-9d9811633368&page=queryresults
[0m14:33:23.571308 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:33:20.054969 => 14:33:23.571034
[0m14:33:23.573546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b00b290>]}
[0m14:33:23.576324 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.54s]
[0m14:33:23.578703 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:33:23.580593 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:33:23.582420 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:33:23.585200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:33:23.587924 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:33:23.594572 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:33:23.598856 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:33:23.590368 => 14:33:23.598245
[0m14:33:23.601210 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:33:23.605570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:24.302303 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:33:24.308445 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID,  -- Selecting and aliasing the Accident_Index column as vehicleID
    a.Number_of_Vehicles AS number_vehicle,  -- Selecting the Number_of_Vehicles column
    v.make AS vehicle_make,  -- Selecting the make column from the vehicle_data table and aliasing it as vehicle_make
    v.Age_of_Vehicle as vehicle_aga,  -- Selecting the Age_of_Vehicle column and aliasing it as vehicle_aga
    v.Skidding_and_Overturning AS skidding_overturning,  -- Selecting the Skidding_and_Overturning column
    v.X1st_Point_of_Impact AS first_Point_Impact  -- Selecting the X1st_Point_of_Impact column
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a  -- Selecting data from the traffic_data table and aliasing it as 'a'
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v  -- Selecting data from the vehicle_data table and aliasing it as 'v'
ON 
    a.Accident_Index = v.Accident_Index  -- Joining the two tables based on the Accident_Index column
    );
  
[0m14:33:27.373322 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:896d8355-2f86-45af-90be-2b2026bcd843&page=queryresults
[0m14:33:27.389306 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:33:23.602931 => 14:33:27.388898
[0m14:33:27.391767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b1c64d0>]}
[0m14:33:27.393806 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 272.3 KiB processed)[0m in 3.81s]
[0m14:33:27.396258 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:33:27.398744 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:33:27.400492 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m14:33:27.403608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m14:33:27.406531 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m14:33:27.417751 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m14:33:27.423157 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 14:33:27.408502 => 14:33:27.422664
[0m14:33:27.425737 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m14:33:27.433035 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m14:33:27.437800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:27.442322 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ve.number_vehicle,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.time_accident,
    dt.year,
    dt.dates,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    ve.vehicle_make,
    ve.vehicle_aga,
    d.driver_age_group,
    d.driver_home_type,
    d.sex,
    ve.skidding_overturning,
    ve.first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_vehicle`) AS ve ON wc.weatherID = ve.vehicleID
    );
  
[0m14:33:28.897421 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name dates not found inside dt at [24:8]; reason: invalidQuery, location: query, message: Name dates not found inside dt at [24:8]')
[0m14:33:30.710871 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:f9e5ce30-e7b6-4fcf-8466-fc2fcebfd8ee&page=queryresults
[0m14:33:30.714933 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 14:33:27.428126 => 14:33:30.714521
[0m14:33:30.724939 [debug] [Thread-1 (]: Database Error in model fct_trafic (models/transform/fct_trafic.sql)
  Name dates not found inside dt at [24:8]
  compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m14:33:30.727006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f883caa2-5a65-4083-9160-c28001233921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954b075c10>]}
[0m14:33:30.730122 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model retail.fct_trafic ........................ [[31mERROR[0m in 3.32s]
[0m14:33:30.732703 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:33:30.736709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:30.738434 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m14:33:30.739820 [info ] [MainThread]: 
[0m14:33:30.741547 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.86 seconds (19.86s).
[0m14:33:30.745058 [debug] [MainThread]: Command end result
[0m14:33:30.771781 [info ] [MainThread]: 
[0m14:33:30.773658 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:33:30.775471 [info ] [MainThread]: 
[0m14:33:30.777857 [error] [MainThread]: [33mDatabase Error in model fct_trafic (models/transform/fct_trafic.sql)[0m
[0m14:33:30.781632 [error] [MainThread]:   Name dates not found inside dt at [24:8]
[0m14:33:30.783664 [error] [MainThread]:   compiled Code at target/run/retail/models/transform/fct_trafic.sql
[0m14:33:30.785956 [info ] [MainThread]: 
[0m14:33:30.787866 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:33:30.789841 [debug] [MainThread]: Command `dbt run` failed at 14:33:30.789694 after 20.80 seconds
[0m14:33:30.791640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d3dab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d934310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954d6520d0>]}
[0m14:33:30.793320 [debug] [MainThread]: Flushing usage events
[0m14:34:13.100822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15123f4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15127299d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1512560750>]}


============================== 14:34:13.103747 | 621df035-3581-42a4-9f39-22865eec0bbc ==============================
[0m14:34:13.103747 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:34:13.105916 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:34:13.693328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150ffa6990>]}
[0m14:34:13.715668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150ffb8250>]}
[0m14:34:13.718345 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:34:13.745104 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:34:13.851450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:13.853181 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_trafic.sql
[0m14:34:13.885723 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m14:34:13.919756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150ffd1b50>]}
[0m14:34:13.938443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150fdfc390>]}
[0m14:34:13.940213 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:34:13.942143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15154b8050>]}
[0m14:34:13.945669 [info ] [MainThread]: 
[0m14:34:13.949391 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:34:13.953084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_data-zoom-camp-ugo'
[0m14:34:13.955043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:14.904002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo, now list_data-zoom-camp-ugo_retail)
[0m14:34:14.906876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:15.725388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15131b46d0>]}
[0m14:34:15.739947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:15.742309 [info ] [MainThread]: 
[0m14:34:15.748510 [debug] [Thread-1 (]: Began running node model.retail.dim_Weather
[0m14:34:15.750976 [info ] [Thread-1 (]: 1 of 5 START sql table model retail.dim_Weather ................................ [RUN]
[0m14:34:15.753574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data-zoom-camp-ugo_retail, now model.retail.dim_Weather)
[0m14:34:15.755145 [debug] [Thread-1 (]: Began compiling node model.retail.dim_Weather
[0m14:34:15.766271 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_Weather"
[0m14:34:15.771007 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (compile): 14:34:15.756420 => 14:34:15.770681
[0m14:34:15.772719 [debug] [Thread-1 (]: Began executing node model.retail.dim_Weather
[0m14:34:15.791965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:16.568142 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_Weather"
[0m14:34:16.573838 [debug] [Thread-1 (]: On model.retail.dim_Weather: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_Weather"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_Weather`
    
    

    OPTIONS()
    as (
      -- weather condition

-- SELECT
--     Accident_Index AS weatherID
--     Weather_Conditions AS weather,
--     Light_Conditions AS light_condition,
--     Road_Surface_Conditions AS road_condition

-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
-- WHERE Accident_Index IS NOT NULL
SELECT
    Accident_Index AS weatherID,
    Weather_Conditions AS weather,
    Light_Conditions AS light_condition,
    Road_Surface_Conditions AS road_condition
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:34:19.828725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:b89848ce-6091-46f2-b691-62a54e299079&page=queryresults
[0m14:34:19.851029 [debug] [Thread-1 (]: Timing info for model.retail.dim_Weather (execute): 14:34:15.774162 => 14:34:19.850760
[0m14:34:19.853775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150fdfcc90>]}
[0m14:34:19.855702 [info ] [Thread-1 (]: 1 of 5 OK created sql table model retail.dim_Weather ........................... [[32mCREATE TABLE (10.0k rows, 540.6 KiB processed)[0m in 4.10s]
[0m14:34:19.857922 [debug] [Thread-1 (]: Finished running node model.retail.dim_Weather
[0m14:34:19.859753 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:34:19.861414 [info ] [Thread-1 (]: 2 of 5 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:34:19.863907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_Weather, now model.retail.dim_datetime)
[0m14:34:19.867358 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:34:19.881123 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:34:19.891304 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:34:19.869324 => 14:34:19.890534
[0m14:34:19.893335 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:34:19.897406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:20.854933 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:34:20.872263 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_datetime`
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

 
-- SELECT
--     Accident_Index AS dateID
--     Year AS year,
--     MONTH(Date) AS month,
--     Day_of_Week AS week_day,
--     DAY(Date) AS day,
--     Time as time
--   FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`
--   WHERE Accident_Index IS NOT NULL

SELECT
    Accident_Index AS dateID,
    Year AS year,
    Day_of_Week AS week_day,
    Date AS accident_date,
    Time AS time_accident
FROM
    `data-zoom-camp-ugo`.`retail`.`traffic_data`
WHERE
    Accident_Index IS NOT NULL
    );
  
[0m14:34:23.576981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:31241073-368f-46a2-ad5f-769846d24add&page=queryresults
[0m14:34:23.582136 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:34:19.894611 => 14:34:23.581789
[0m14:34:23.585559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f151003c8d0>]}
[0m14:34:23.587716 [info ] [Thread-1 (]: 2 of 5 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (10.0k rows, 497.8 KiB processed)[0m in 3.72s]
[0m14:34:23.590504 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:34:23.592756 [debug] [Thread-1 (]: Began running node model.retail.dim_driver
[0m14:34:23.594910 [info ] [Thread-1 (]: 3 of 5 START sql table model retail.dim_driver ................................. [RUN]
[0m14:34:23.598125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_driver)
[0m14:34:23.600301 [debug] [Thread-1 (]: Began compiling node model.retail.dim_driver
[0m14:34:23.606356 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_driver"
[0m14:34:23.613129 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (compile): 14:34:23.602408 => 14:34:23.612187
[0m14:34:23.616021 [debug] [Thread-1 (]: Began executing node model.retail.dim_driver
[0m14:34:23.621235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:24.314206 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_driver"
[0m14:34:24.320559 [debug] [Thread-1 (]: On model.retail.dim_driver: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_driver"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_driver`
    
    

    OPTIONS()
    as (
      -- dim_driver.sql

-- Create the dimension table

SELECT
	Accident_Index AS driverID,
	Age_Band_of_Driver AS driver_age_group,
    Driver_Home_Area_Type AS driver_home_type,
    Sex_of_Driver AS sex
FROM `data-zoom-camp-ugo`.`retail`.`vehicle_data`
WHERE Accident_Index IS NOT NULL
    );
  
[0m14:34:27.106302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:46c61935-5197-4da3-8e01-291aae579062&page=queryresults
[0m14:34:27.125152 [debug] [Thread-1 (]: Timing info for model.retail.dim_driver (execute): 14:34:23.618052 => 14:34:27.124875
[0m14:34:27.127563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150ffff7d0>]}
[0m14:34:27.129603 [info ] [Thread-1 (]: 3 of 5 OK created sql table model retail.dim_driver ............................ [[32mCREATE TABLE (1.0k rows, 46.8 KiB processed)[0m in 3.53s]
[0m14:34:27.132151 [debug] [Thread-1 (]: Finished running node model.retail.dim_driver
[0m14:34:27.133873 [debug] [Thread-1 (]: Began running node model.retail.dim_vehicle
[0m14:34:27.135616 [info ] [Thread-1 (]: 4 of 5 START sql table model retail.dim_vehicle ................................ [RUN]
[0m14:34:27.138717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_driver, now model.retail.dim_vehicle)
[0m14:34:27.140873 [debug] [Thread-1 (]: Began compiling node model.retail.dim_vehicle
[0m14:34:27.147220 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_vehicle"
[0m14:34:27.153593 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (compile): 14:34:27.142950 => 14:34:27.153013
[0m14:34:27.156209 [debug] [Thread-1 (]: Began executing node model.retail.dim_vehicle
[0m14:34:27.160326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:28.205372 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_vehicle"
[0m14:34:28.211411 [debug] [Thread-1 (]: On model.retail.dim_vehicle: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_vehicle"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`dim_vehicle`
    
    

    OPTIONS()
    as (
      -- Create the dimension table
-- SELECT 
--     a.Number_of_Vehicles AS number_vehicle,
--     v.make
--     v.Age_of_Vehicle as vehicle_aga
-- FROM `data-zoom-camp-ugo`.`retail`.`traffic_data` as a 
-- JOIN `data-zoom-camp-ugo`.`retail`.`vehicle_data` as v 
-- ON a.Accident_Index = v.Accident_Index
SELECT 
    a.Accident_Index AS vehicleID,  -- Selecting and aliasing the Accident_Index column as vehicleID
    a.Number_of_Vehicles AS number_vehicle,  -- Selecting the Number_of_Vehicles column
    v.make AS vehicle_make,  -- Selecting the make column from the vehicle_data table and aliasing it as vehicle_make
    v.Age_of_Vehicle as vehicle_aga,  -- Selecting the Age_of_Vehicle column and aliasing it as vehicle_aga
    v.Skidding_and_Overturning AS skidding_overturning,  -- Selecting the Skidding_and_Overturning column
    v.X1st_Point_of_Impact AS first_Point_Impact  -- Selecting the X1st_Point_of_Impact column
FROM 
    `data-zoom-camp-ugo`.`retail`.`traffic_data` AS a  -- Selecting data from the traffic_data table and aliasing it as 'a'
JOIN 
    `data-zoom-camp-ugo`.`retail`.`vehicle_data` AS v  -- Selecting data from the vehicle_data table and aliasing it as 'v'
ON 
    a.Accident_Index = v.Accident_Index  -- Joining the two tables based on the Accident_Index column
    );
  
[0m14:34:31.685596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:3d556378-558c-4b93-948c-204ff95ef40e&page=queryresults
[0m14:34:31.689786 [debug] [Thread-1 (]: Timing info for model.retail.dim_vehicle (execute): 14:34:27.157760 => 14:34:31.689505
[0m14:34:31.691928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150ff21f10>]}
[0m14:34:31.694278 [info ] [Thread-1 (]: 4 of 5 OK created sql table model retail.dim_vehicle ........................... [[32mCREATE TABLE (0.0 rows, 272.3 KiB processed)[0m in 4.55s]
[0m14:34:31.697044 [debug] [Thread-1 (]: Finished running node model.retail.dim_vehicle
[0m14:34:31.700592 [debug] [Thread-1 (]: Began running node model.retail.fct_trafic
[0m14:34:31.703343 [info ] [Thread-1 (]: 5 of 5 START sql table model retail.fct_trafic ................................. [RUN]
[0m14:34:31.706750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_vehicle, now model.retail.fct_trafic)
[0m14:34:31.708616 [debug] [Thread-1 (]: Began compiling node model.retail.fct_trafic
[0m14:34:31.717480 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_trafic"
[0m14:34:31.727285 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (compile): 14:34:31.710071 => 14:34:31.726370
[0m14:34:31.729738 [debug] [Thread-1 (]: Began executing node model.retail.fct_trafic
[0m14:34:31.735108 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_trafic"
[0m14:34:31.740775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:31.745139 [debug] [Thread-1 (]: On model.retail.fct_trafic: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_trafic"} */

  
    

    create or replace table `data-zoom-camp-ugo`.`retail`.`fct_trafic`
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql
SELECT
    ft.Accident_Index AS accident_id,
    ft.Accident_Severity AS severity,
    dt.week_day,
    ve.number_vehicle,
    ft.Number_of_Casualties AS number_Casualties,
    ft.Pedestrian_Crossing_Human_Control AS pc_human_control,
    ft.Pedestrian_Crossing_Physical_Facilities AS pc_physical,
    ft.Speed_limit AS speed,
    dt.time_accident,
    dt.year,
    dt.accident_date,
    wc.weather,
    wc.light_condition,
    wc.road_condition,
    ve.vehicle_make,
    ve.vehicle_aga,
    d.driver_age_group,
    d.driver_home_type,
    d.sex,
    ve.skidding_overturning,
    ve.first_Point_Impact
FROM 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`traffic_data`) AS ft
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_driver`) AS d ON ft.Accident_Index = d.driverID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_datetime`) AS dt ON d.driverID = dt.dateID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_Weather`) AS wc ON dt.dateID = wc.weatherID
JOIN 
    (SELECT * FROM `data-zoom-camp-ugo`.`retail`.`dim_vehicle`) AS ve ON wc.weatherID = ve.vehicleID
    );
  
[0m14:34:35.578964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=data-zoom-camp-ugo&j=bq:US:b6b3bd62-e2a1-4104-b013-3592e6aae2f6&page=queryresults
[0m14:34:35.594154 [debug] [Thread-1 (]: Timing info for model.retail.fct_trafic (execute): 14:34:31.731282 => 14:34:35.593885
[0m14:34:35.596273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '621df035-3581-42a4-9f39-22865eec0bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f150fed7490>]}
[0m14:34:35.598732 [info ] [Thread-1 (]: 5 of 5 OK created sql table model retail.fct_trafic ............................ [[32mCREATE TABLE (0.0 rows, 1.6 MiB processed)[0m in 3.89s]
[0m14:34:35.601078 [debug] [Thread-1 (]: Finished running node model.retail.fct_trafic
[0m14:34:35.605020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:35.607244 [debug] [MainThread]: Connection 'model.retail.fct_trafic' was properly closed.
[0m14:34:35.609455 [info ] [MainThread]: 
[0m14:34:35.612389 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 21.66 seconds (21.66s).
[0m14:34:35.616166 [debug] [MainThread]: Command end result
[0m14:34:35.655718 [info ] [MainThread]: 
[0m14:34:35.662492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:35.665431 [info ] [MainThread]: 
[0m14:34:35.668198 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:34:35.670632 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:35.670387 after 22.61 seconds
[0m14:34:35.672501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1512728f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1511f861d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1512711c50>]}
[0m14:34:35.675748 [debug] [MainThread]: Flushing usage events


============================== 2024-04-04 11:05:18.084293 | 56798b1a-935d-404a-ac09-07871df131ce ==============================
[0m11:05:18.084293 [info ] [MainThread]: Running with dbt=1.4.9
[0m11:05:18.088176 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m11:05:18.089834 [debug] [MainThread]: Tracking: tracking
[0m11:05:18.093872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2a180090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c32332050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2a180d10>]}
[0m11:05:18.146843 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m11:05:18.191661 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:05:18.193654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56798b1a-935d-404a-ac09-07871df131ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2a0c07d0>]}
[0m11:05:19.690890 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m11:05:19.708474 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m11:05:19.714510 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_driver.sql
[0m11:05:19.720074 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m11:05:19.725290 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m11:05:19.817625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56798b1a-935d-404a-ac09-07871df131ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c30195fd0>]}
[0m11:05:19.838880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56798b1a-935d-404a-ac09-07871df131ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2a201050>]}
[0m11:05:19.840193 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:05:19.841311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56798b1a-935d-404a-ac09-07871df131ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c32332050>]}
[0m11:05:19.843314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c4c453550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2a217050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2a9cf850>]}
[0m11:05:19.844488 [debug] [MainThread]: Flushing usage events


============================== 2024-04-04 11:16:13.776070 | 7548e5d8-fdf8-45aa-99cc-a029e96abc8a ==============================
[0m11:16:13.776070 [info ] [MainThread]: Running with dbt=1.4.9
[0m11:16:13.780476 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m11:16:13.782903 [debug] [MainThread]: Tracking: tracking
[0m11:16:13.787314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d714194d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d71435110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d72989c50>]}
[0m11:16:13.817088 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m11:16:13.841901 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:16:13.843571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7548e5d8-fdf8-45aa-99cc-a029e96abc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d71370ed0>]}
[0m11:16:15.163411 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m11:16:15.179705 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m11:16:15.185725 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_driver.sql
[0m11:16:15.191898 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m11:16:15.198483 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m11:16:15.277070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7548e5d8-fdf8-45aa-99cc-a029e96abc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d71454690>]}
[0m11:16:15.294803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7548e5d8-fdf8-45aa-99cc-a029e96abc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d7042eb50>]}
[0m11:16:15.296351 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:16:15.297641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7548e5d8-fdf8-45aa-99cc-a029e96abc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d93daf050>]}
[0m11:16:15.299839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d93daf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d714babd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d714a9c50>]}
[0m11:16:15.301257 [debug] [MainThread]: Flushing usage events


============================== 2024-04-04 11:16:50.345630 | 4c18bc83-9fe4-47f8-b1ec-9e9831bea5c0 ==============================
[0m11:16:50.345630 [info ] [MainThread]: Running with dbt=1.4.9
[0m11:16:50.348501 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m11:16:50.350673 [debug] [MainThread]: Tracking: tracking
[0m11:16:50.353799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfb0153d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1ba97510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfb018dd0>]}
[0m11:16:50.378229 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m11:16:50.509070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:50.511027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:50.520276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c18bc83-9fe4-47f8-b1ec-9e9831bea5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfaf4c390>]}
[0m11:16:50.544684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c18bc83-9fe4-47f8-b1ec-9e9831bea5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfb01f750>]}
[0m11:16:50.546920 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:16:50.548838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c18bc83-9fe4-47f8-b1ec-9e9831bea5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfb138790>]}
[0m11:16:50.551788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1fc09610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0315ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1d753a10>]}
[0m11:16:50.553511 [debug] [MainThread]: Flushing usage events


============================== 2024-04-04 11:17:25.868364 | 300691b8-32a1-431d-9db0-3d45faebdc6d ==============================
[0m11:17:25.868364 [info ] [MainThread]: Running with dbt=1.4.9
[0m11:17:25.870962 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m11:17:25.872587 [debug] [MainThread]: Tracking: tracking
[0m11:17:25.875683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7fca41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7fca4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7fca5110>]}
[0m11:17:25.898382 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m11:17:25.915973 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:17:25.917916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '300691b8-32a1-431d-9db0-3d45faebdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b85a53ed0>]}
[0m11:17:27.177584 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_Weather.sql
[0m11:17:27.194687 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_datetime.sql
[0m11:17:27.201376 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_driver.sql
[0m11:17:27.207188 [debug] [MainThread]: 1699: static parser successfully parsed transform/dim_vehicle.sql
[0m11:17:27.212972 [debug] [MainThread]: 1699: static parser successfully parsed transform/fct_trafic.sql
[0m11:17:27.296282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '300691b8-32a1-431d-9db0-3d45faebdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7fcb4050>]}
[0m11:17:27.315307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '300691b8-32a1-431d-9db0-3d45faebdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7faba910>]}
[0m11:17:27.317021 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:17:27.318323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '300691b8-32a1-431d-9db0-3d45faebdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba2414850>]}
[0m11:17:27.320704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba205ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b84b71d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b843fa650>]}
[0m11:17:27.322115 [debug] [MainThread]: Flushing usage events


============================== 2024-04-04 11:18:01.876741 | f4033506-530b-4823-911d-6b31ee892cde ==============================
[0m11:18:01.876741 [info ] [MainThread]: Running with dbt=1.4.9
[0m11:18:01.879466 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'profile': 'retail', 'target': 'dev', 'resource_types': [], 'output': 'json', 'select': ['path:models/transform'], 'indirect_selection': 'eager', 'which': 'list'}
[0m11:18:01.881175 [debug] [MainThread]: Tracking: tracking
[0m11:18:01.884565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70bea190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70d2c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf74d9ce10>]}
[0m11:18:01.907680 [debug] [MainThread]: checksum: 92ac18e3946ee15d4e746c8727084f9c56105a52d4376fcc276fb9af4f10a87c, vars: {}, profile: retail, target: dev, version: 1.4.9
[0m11:18:02.023951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:02.026083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:02.033874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4033506-530b-4823-911d-6b31ee892cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8d688050>]}
[0m11:18:02.055867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4033506-530b-4823-911d-6b31ee892cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70c03310>]}
[0m11:18:02.058054 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 451 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:18:02.059963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4033506-530b-4823-911d-6b31ee892cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70d149d0>]}
[0m11:18:02.063351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf71b8b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70c034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70c03710>]}
[0m11:18:02.065240 [debug] [MainThread]: Flushing usage events
